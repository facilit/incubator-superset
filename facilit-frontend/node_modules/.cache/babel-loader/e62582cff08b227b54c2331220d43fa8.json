{"ast":null,"code":"import _filterInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/filter\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _concatInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/concat\";import _parseFloat from \"@babel/runtime-corejs3/core-js-stable/parse-float\";import _parseInt from \"@babel/runtime-corejs3/core-js-stable/parse-int\";import _findInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/find\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";import _Set from \"@babel/runtime-corejs3/core-js-stable/set\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { OverlayTrigger, Popover } from 'react-bootstrap';\nimport { t } from '@superset-ui/translation';\n\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport FormRow from '../../../components/FormRow';\nimport SelectControl from './SelectControl';\nimport CheckboxControl from './CheckboxControl';\nimport TextControl from './TextControl';\nimport { FILTER_CONFIG_ATTRIBUTES } from '../../constants';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nconst INTEGRAL_TYPES = new _Set([\n'TINYINT',\n'SMALLINT',\n'INT',\n'INTEGER',\n'BIGINT',\n'LONG']);\n\nconst DECIMAL_TYPES = new _Set([\n'FLOAT',\n'DOUBLE',\n'REAL',\n'NUMERIC',\n'DECIMAL',\n'MONEY']);\n\n\nconst propTypes = {\n  datasource: PropTypes.object.isRequired,\n  onChange: PropTypes.func,\n  asc: PropTypes.bool,\n  clearable: PropTypes.bool,\n  multiple: PropTypes.bool,\n  column: PropTypes.string,\n  metric: PropTypes.string,\n  defaultValue: PropTypes.string };\n\n\nconst defaultProps = {\n  onChange: () => {},\n  asc: true,\n  clearable: true,\n  multiple: true };\n\n\nconst STYLE_WIDTH = { width: 350 };\n\nexport default class FilterBoxItemControl extends React.Component {\n  constructor(props) {var _context, _context2;\n    super(props);\n    const { column, metric, asc, clearable, multiple, defaultValue } = props;\n    const state = { column, metric, asc, clearable, multiple, defaultValue };\n    this.state = state;\n    this.onChange = _bindInstanceProperty(_context = this.onChange).call(_context, this);\n    this.onControlChange = _bindInstanceProperty(_context2 = this.onControlChange).call(_context2, this);\n  }\n  onChange() {\n    this.props.onChange(this.state);\n  }\n  onControlChange(attr, value) {\n    let typedValue = value;\n    const { column: selectedColumnName, multiple } = this.state;\n    if (value && !multiple && attr === FILTER_CONFIG_ATTRIBUTES.DEFAULT_VALUE) {var _context3;\n      // if single value filter_box,\n      // convert input value string to the column's data type\n      const { datasource } = this.props;\n      const selectedColumn = _findInstanceProperty(_context3 = datasource.columns).call(_context3,\n      col => col.column_name === selectedColumnName);\n\n\n      if (selectedColumn && selectedColumn.type) {\n        const type = selectedColumn.type.toUpperCase();\n        if (type === 'BOOLEAN') {\n          typedValue = value === 'true';\n        } else if (INTEGRAL_TYPES.has(type)) {\n          typedValue = isNaN(value) ? null : _parseInt(value, 10);\n        } else if (DECIMAL_TYPES.has(type)) {\n          typedValue = isNaN(value) ? null : _parseFloat(value);\n        }\n      }\n    }\n    this.setState({ [attr]: typedValue }, this.onChange);\n  }\n  setType() {}\n  textSummary() {\n    return this.state.column || 'N/A';\n  }\n  renderForm() {var _context4, _context5, _context6, _context7, _context8, _context9;\n    return (\n      ___EmotionJSX(\"div\", null,\n      ___EmotionJSX(FormRow, {\n        label: t('Column'),\n        control:\n        ___EmotionJSX(SelectControl, {\n          value: this.state.column,\n          name: \"column\",\n          clearable: false,\n          options: _concatInstanceProperty(_context4 = _mapInstanceProperty(_context5 = _filterInstanceProperty(_context6 = this.props.datasource.columns).call(_context6,\n          col => col !== this.state.column)).call(_context5,\n          col => ({\n            value: col.column_name,\n            label: col.column_name }))).call(_context4,\n\n          [\n          { value: this.state.column, label: this.state.column }]),\n\n          onChange: v => this.onControlChange('column', v) }) }),\n\n\n\n      ___EmotionJSX(FormRow, {\n        label: t('Label'),\n        control:\n        ___EmotionJSX(TextControl, {\n          value: this.state.label,\n          name: \"label\",\n          onChange: v => this.onControlChange('label', v) }) }),\n\n\n\n      ___EmotionJSX(FormRow, {\n        label: t('Default'),\n        tooltip: t(\n        '(optional) default value for the filter, when using ' +\n        'the multiple option, you can use a semicolon-delimited list ' +\n        'of options.'),\n\n        control:\n        ___EmotionJSX(TextControl, {\n          value: this.state.defaultValue,\n          name: \"defaultValue\",\n          onChange: (v) =>\n          this.onControlChange(FILTER_CONFIG_ATTRIBUTES.DEFAULT_VALUE, v) }) }),\n\n\n\n\n      ___EmotionJSX(FormRow, {\n        label: t('Sort Metric'),\n        tooltip: t('Metric to sort the results by'),\n        control:\n        ___EmotionJSX(SelectControl, {\n          value: this.state.metric,\n          name: \"column\",\n          options: _concatInstanceProperty(_context7 = _mapInstanceProperty(_context8 = _filterInstanceProperty(_context9 = this.props.datasource.metrics).call(_context9,\n          metric => metric !== this.state.metric)).call(_context8,\n          m => ({\n            value: m.metric_name,\n            label: m.metric_name }))).call(_context7,\n\n          [\n          { value: this.state.metric, label: this.state.metric }]),\n\n          onChange: v => this.onControlChange('metric', v) }) }),\n\n\n\n      ___EmotionJSX(FormRow, {\n        label: t('Sort Ascending'),\n        tooltip: t('Check for sorting ascending'),\n        isCheckbox: true,\n        control:\n        ___EmotionJSX(CheckboxControl, {\n          value: this.state.asc,\n          onChange: v => this.onControlChange('asc', v) }) }),\n\n\n\n      ___EmotionJSX(FormRow, {\n        label: t('Allow Multiple Selections'),\n        isCheckbox: true,\n        tooltip: t(\n        'Multiple selections allowed, otherwise filter ' +\n        'is limited to a single value'),\n\n        control:\n        ___EmotionJSX(CheckboxControl, {\n          value: this.state.multiple,\n          onChange: (v) =>\n          this.onControlChange(FILTER_CONFIG_ATTRIBUTES.MULTIPLE, v) }) }),\n\n\n\n\n      ___EmotionJSX(FormRow, {\n        label: t('Required'),\n        tooltip: t('User must select a value for this filter'),\n        isCheckbox: true,\n        control:\n        ___EmotionJSX(CheckboxControl, {\n          value: !this.state.clearable,\n          onChange: v => this.onControlChange('clearable', !v) }) })));\n\n\n\n\n\n  }\n  renderPopover() {\n    return (\n      ___EmotionJSX(Popover, { id: \"ts-col-popo\", title: t('Filter Configuration') },\n      ___EmotionJSX(\"div\", { style: STYLE_WIDTH }, this.renderForm())));\n\n\n  }\n  render() {\n    return (\n      ___EmotionJSX(\"span\", null,\n      this.textSummary(), ' ',\n      ___EmotionJSX(OverlayTrigger, {\n        container: document.body,\n        trigger: \"click\",\n        rootClose: true,\n        ref: \"trigger\",\n        placement: \"right\",\n        overlay: this.renderPopover() },\n\n      ___EmotionJSX(InfoTooltipWithTrigger, {\n        icon: \"edit\",\n        className: \"text-primary\",\n        label: \"edit-ts-column\" }))));\n\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nFilterBoxItemControl.propTypes = propTypes;\nFilterBoxItemControl.defaultProps = defaultProps;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(INTEGRAL_TYPES, \"INTEGRAL_TYPES\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/FilterBoxItemControl.jsx\");reactHotLoader.register(DECIMAL_TYPES, \"DECIMAL_TYPES\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/FilterBoxItemControl.jsx\");reactHotLoader.register(propTypes, \"propTypes\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/FilterBoxItemControl.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/FilterBoxItemControl.jsx\");reactHotLoader.register(STYLE_WIDTH, \"STYLE_WIDTH\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/FilterBoxItemControl.jsx\");reactHotLoader.register(FilterBoxItemControl, \"FilterBoxItemControl\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/FilterBoxItemControl.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":null,"metadata":{},"sourceType":"module"}