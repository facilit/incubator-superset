{"ast":null,"code":"import \"core-js/modules/es.promise\";import \"core-js/modules/es.promise.finally\";import \"core-js/modules/es.string.search\";import \"core-js/modules/web.dom-collections.iterator\";import _Object$assign from \"@babel/runtime-corejs3/core-js-stable/object/assign\";import _JSON$stringify from \"@babel/runtime-corejs3/core-js-stable/json/stringify\";import _Object$keys from \"@babel/runtime-corejs3/core-js-stable/object/keys\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _concatInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/concat\";import _defineProperty from \"@babel/runtime-corejs3/helpers/defineProperty\";import _debounce from \"lodash/debounce\";var _jsxFileName = \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/welcome/DashboardTable.jsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { t } from '@superset-ui/translation';\nimport { SupersetClient } from '@superset-ui/connection';\nimport moment from 'moment';\n\nimport ListView from 'src/components/ListView/ListView';\nimport withToasts from 'src/messageToasts/enhancers/withToasts';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nconst PAGE_SIZE = 25;\n\nclass DashboardTable extends React.PureComponent {constructor(...args) {super(...args);_defineProperty(this, \"state\",\n\n\n\n\n\n    {\n      dashboards: [],\n      dashboard_count: 0,\n      loading: false });_defineProperty(this, \"columns\",\n\n\n\n\n\n\n\n\n\n\n\n\n\n    [\n    {\n      accessor: 'dashboard_title',\n      Header: 'Dashboard',\n      sortable: true,\n      Cell: ({\n        row: {\n          original: { url, dashboard_title: dashboardTitle } } }) =>\n\n      ___EmotionJSX(\"a\", { href: url, __source: { fileName: _jsxFileName, lineNumber: 62 }, __self: this }, dashboardTitle) },\n\n    {\n      accessor: 'changed_by_fk',\n      Header: 'Creator',\n      sortable: true,\n      Cell: ({\n        row: {\n          original: { changed_by_name: changedByName, changedByUrl } } }) =>\n\n      ___EmotionJSX(\"a\", { href: changedByUrl, __source: { fileName: _jsxFileName, lineNumber: 72 }, __self: this }, changedByName) },\n\n    {\n      accessor: 'changed_on',\n      Header: 'Modified',\n      sortable: true,\n      Cell: ({\n        row: {\n          original: { changed_on: changedOn } } }) =>\n\n      ___EmotionJSX(\"span\", { className: \"no-wrap\", __source: { fileName: _jsxFileName, lineNumber: 82 }, __self: this }, moment(changedOn).fromNow()) }]);_defineProperty(this, \"initialSort\",\n\n\n\n    [{ id: 'changed_on', desc: true }]);_defineProperty(this, \"fetchData\",\n\n    ({ pageIndex, pageSize, sortBy, filters }) => {var _context, _context2;\n      this.setState({ loading: true });\n      const filterExps = _concatInstanceProperty(_context = _mapInstanceProperty(_context2 = _Object$keys(filters)).call(_context2,\n      fk => ({\n        col: fk,\n        opr: filters[fk].filterId,\n        value: filters[fk].filterValue }))).call(_context,\n\n\n      this.props.search ?\n      [\n      {\n        col: 'dashboard_title',\n        opr: 'ct',\n        value: this.props.search }] :\n\n\n      []);\n\n\n      const queryParams = _JSON$stringify(_Object$assign({\n        order_column: sortBy[0].id,\n        order_direction: sortBy[0].desc ? 'desc' : 'asc',\n        page: pageIndex,\n        page_size: pageSize },\n      filterExps.length ? { filters: filterExps } : {}));\n\n\n      return SupersetClient.get({\n        endpoint: \"/api/v1/dashboard/?q=\" + queryParams }).\n\n      then(({ json }) => {\n        this.setState({ dashboards: json.result, dashboard_count: json.count });\n      }).\n      catch(response => {\n        if (response.status === 401) {\n          this.props.addDangerToast(\n          t(\n          \"You don't have the necessary permissions to load dashboards. Please contact your administrator.\"));\n\n\n        } else {\n          this.props.addDangerToast(\n          t('An error occurred while fetching Dashboards'));\n\n        }\n      }).\n      finally(() => this.setState({ loading: false }));\n    });_defineProperty(this, \"fetchDataDebounced\",\n\n    _debounce(this.fetchData, 200));}componentDidUpdate(prevProps) {if (prevProps.search !== this.props.search) {this.fetchDataDebounced({ pageSize: PAGE_SIZE, pageIndex: 0, sortBy: this.initialSort, filters: {} });}}\n\n  render() {\n    return (\n      ___EmotionJSX(ListView, {\n        columns: this.columns,\n        data: this.state.dashboards,\n        count: this.state.dashboard_count,\n        pageSize: PAGE_SIZE,\n        fetchData: this.fetchData,\n        loading: this.state.loading,\n        initialSort: this.initialSort, __source: { fileName: _jsxFileName, lineNumber: 142 }, __self: this }));\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}_defineProperty(DashboardTable, \"propTypes\", { addDangerToast: PropTypes.func.isRequired, search: PropTypes.string });const _default =\nwithToasts(DashboardTable);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(PAGE_SIZE, \"PAGE_SIZE\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/welcome/DashboardTable.jsx\");reactHotLoader.register(DashboardTable, \"DashboardTable\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/welcome/DashboardTable.jsx\");reactHotLoader.register(_default, \"default\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/welcome/DashboardTable.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/tiago/git-facilit/incubator-superset/superset-frontend/src/welcome/DashboardTable.jsx"],"names":["React","PropTypes","t","SupersetClient","moment","ListView","withToasts","PAGE_SIZE","DashboardTable","PureComponent","dashboards","dashboard_count","loading","accessor","Header","sortable","Cell","row","original","url","dashboard_title","dashboardTitle","changed_by_name","changedByName","changedByUrl","changed_on","changedOn","fromNow","id","desc","pageIndex","pageSize","sortBy","filters","setState","filterExps","fk","col","opr","filterId","value","filterValue","props","search","queryParams","order_column","order_direction","page","page_size","length","get","endpoint","then","json","result","count","catch","response","status","addDangerToast","finally","fetchData","componentDidUpdate","prevProps","fetchDataDebounced","initialSort","render","columns","state","func","isRequired","string"],"mappings":"gmCAAA;;;;;;;;;;;;;;;;;;AAkBA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,CAAT,QAAkB,0BAAlB;AACA,SAASC,cAAT,QAA+B,yBAA/B;AACA,OAAOC,MAAP,MAAmB,QAAnB;;AAEA,OAAOC,QAAP,MAAqB,kCAArB;AACA,OAAOC,UAAP,MAAuB,wCAAvB,C;;AAEA,MAAMC,SAAS,GAAG,EAAlB;;AAEA,MAAMC,cAAN,SAA6BR,KAAK,CAACS,aAAnC,CAAiD;;;;;;AAMvC;AACNC,MAAAA,UAAU,EAAE,EADN;AAENC,MAAAA,eAAe,EAAE,CAFX;AAGNC,MAAAA,OAAO,EAAE,KAHH,EANuC;;;;;;;;;;;;;;AAuBrC;AACR;AACEC,MAAAA,QAAQ,EAAE,iBADZ;AAEEC,MAAAA,MAAM,EAAE,WAFV;AAGEC,MAAAA,QAAQ,EAAE,IAHZ;AAIEC,MAAAA,IAAI,EAAE,CAAC;AACLC,QAAAA,GAAG,EAAE;AACHC,UAAAA,QAAQ,EAAE,EAAEC,GAAF,EAAOC,eAAe,EAAEC,cAAxB,EADP,EADA,EAAD;;AAIA,2BAAG,IAAI,EAAEF,GAAT,wEAAeE,cAAf,CARR,EADQ;;AAWR;AACER,MAAAA,QAAQ,EAAE,eADZ;AAEEC,MAAAA,MAAM,EAAE,SAFV;AAGEC,MAAAA,QAAQ,EAAE,IAHZ;AAIEC,MAAAA,IAAI,EAAE,CAAC;AACLC,QAAAA,GAAG,EAAE;AACHC,UAAAA,QAAQ,EAAE,EAAEI,eAAe,EAAEC,aAAnB,EAAkCC,YAAlC,EADP,EADA,EAAD;;AAIA,2BAAG,IAAI,EAAEA,YAAT,wEAAwBD,aAAxB,CARR,EAXQ;;AAqBR;AACEV,MAAAA,QAAQ,EAAE,YADZ;AAEEC,MAAAA,MAAM,EAAE,UAFV;AAGEC,MAAAA,QAAQ,EAAE,IAHZ;AAIEC,MAAAA,IAAI,EAAE,CAAC;AACLC,QAAAA,GAAG,EAAE;AACHC,UAAAA,QAAQ,EAAE,EAAEO,UAAU,EAAEC,SAAd,EADP,EADA,EAAD;;AAIA,8BAAM,SAAS,EAAC,SAAhB,wEAA2BtB,MAAM,CAACsB,SAAD,CAAN,CAAkBC,OAAlB,EAA3B,CARR,EArBQ,CAvBqC;;;;AAwDjC,KAAC,EAAEC,EAAE,EAAE,YAAN,EAAoBC,IAAI,EAAE,IAA1B,EAAD,CAxDiC;;AA0DnC,KAAC,EAAEC,SAAF,EAAaC,QAAb,EAAuBC,MAAvB,EAA+BC,OAA/B,EAAD,KAA8C;AACxD,WAAKC,QAAL,CAAc,EAAEtB,OAAO,EAAE,IAAX,EAAd;AACA,YAAMuB,UAAU,GAAG,iFAAYF,OAAZ;AACZG,MAAAA,EAAE,KAAK;AACVC,QAAAA,GAAG,EAAED,EADK;AAEVE,QAAAA,GAAG,EAAEL,OAAO,CAACG,EAAD,CAAP,CAAYG,QAFP;AAGVC,QAAAA,KAAK,EAAEP,OAAO,CAACG,EAAD,CAAP,CAAYK,WAHT,EAAL,CADU;;;AAOf,WAAKC,KAAL,CAAWC,MAAX;AACI;AACE;AACEN,QAAAA,GAAG,EAAE,iBADP;AAEEC,QAAAA,GAAG,EAAE,IAFP;AAGEE,QAAAA,KAAK,EAAE,KAAKE,KAAL,CAAWC,MAHpB,EADF,CADJ;;;AAQI,QAfW,CAAnB;;;AAkBA,YAAMC,WAAW,GAAG;AAClBC,QAAAA,YAAY,EAAEb,MAAM,CAAC,CAAD,CAAN,CAAUJ,EADN;AAElBkB,QAAAA,eAAe,EAAEd,MAAM,CAAC,CAAD,CAAN,CAAUH,IAAV,GAAiB,MAAjB,GAA0B,KAFzB;AAGlBkB,QAAAA,IAAI,EAAEjB,SAHY;AAIlBkB,QAAAA,SAAS,EAAEjB,QAJO;AAKdI,MAAAA,UAAU,CAACc,MAAX,GAAoB,EAAEhB,OAAO,EAAEE,UAAX,EAApB,GAA8C,EALhC,EAApB;;;AAQA,aAAOhC,cAAc,CAAC+C,GAAf,CAAmB;AACxBC,QAAAA,QAAQ,4BAA0BP,WADV,EAAnB;;AAGJQ,MAAAA,IAHI,CAGC,CAAC,EAAEC,IAAF,EAAD,KAAc;AAClB,aAAKnB,QAAL,CAAc,EAAExB,UAAU,EAAE2C,IAAI,CAACC,MAAnB,EAA2B3C,eAAe,EAAE0C,IAAI,CAACE,KAAjD,EAAd;AACD,OALI;AAMJC,MAAAA,KANI,CAMEC,QAAQ,IAAI;AACjB,YAAIA,QAAQ,CAACC,MAAT,KAAoB,GAAxB,EAA6B;AAC3B,eAAKhB,KAAL,CAAWiB,cAAX;AACEzD,UAAAA,CAAC;AACC,2GADD,CADH;;;AAKD,SAND,MAMO;AACL,eAAKwC,KAAL,CAAWiB,cAAX;AACEzD,UAAAA,CAAC,CAAC,6CAAD,CADH;;AAGD;AACF,OAlBI;AAmBJ0D,MAAAA,OAnBI,CAmBI,MAAM,KAAK1B,QAAL,CAAc,EAAEtB,OAAO,EAAE,KAAX,EAAd,CAnBV,CAAP;AAoBD,KA1G8C;;AA4G1B,cAAS,KAAKiD,SAAd,EAAyB,GAAzB,CA5G0B,GAY/CC,kBAAkB,CAACC,SAAD,EAAY,CAC5B,IAAIA,SAAS,CAACpB,MAAV,KAAqB,KAAKD,KAAL,CAAWC,MAApC,EAA4C,CAC1C,KAAKqB,kBAAL,CAAwB,EACtBjC,QAAQ,EAAExB,SADY,EAEtBuB,SAAS,EAAE,CAFW,EAGtBE,MAAM,EAAE,KAAKiC,WAHS,EAItBhC,OAAO,EAAE,EAJa,EAAxB,EAMD,CACF;;AAyFDiC,EAAAA,MAAM,GAAG;AACP;AACE,oBAAC,QAAD;AACE,QAAA,OAAO,EAAE,KAAKC,OADhB;AAEE,QAAA,IAAI,EAAE,KAAKC,KAAL,CAAW1D,UAFnB;AAGE,QAAA,KAAK,EAAE,KAAK0D,KAAL,CAAWzD,eAHpB;AAIE,QAAA,QAAQ,EAAEJ,SAJZ;AAKE,QAAA,SAAS,EAAE,KAAKsD,SALlB;AAME,QAAA,OAAO,EAAE,KAAKO,KAAL,CAAWxD,OANtB;AAOE,QAAA,WAAW,EAAE,KAAKqD,WAPpB,wEADF;;;AAWD,GA1H8C;AAAA;AAAA,6B,gBAA3CzD,c,eACe,EACjBmD,cAAc,EAAE1D,SAAS,CAACoE,IAAV,CAAeC,UADd,EAEjB3B,MAAM,EAAE1C,SAAS,CAACsE,MAFD,E;AA4HNjE,UAAU,CAACE,cAAD,C,CAAzB,wB,iLA/HMD,S,sIAEAC,c","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { t } from '@superset-ui/translation';\nimport { SupersetClient } from '@superset-ui/connection';\nimport moment from 'moment';\nimport { debounce } from 'lodash';\nimport ListView from 'src/components/ListView/ListView';\nimport withToasts from 'src/messageToasts/enhancers/withToasts';\n\nconst PAGE_SIZE = 25;\n\nclass DashboardTable extends React.PureComponent {\n  static propTypes = {\n    addDangerToast: PropTypes.func.isRequired,\n    search: PropTypes.string,\n  };\n\n  state = {\n    dashboards: [],\n    dashboard_count: 0,\n    loading: false,\n  };\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.search !== this.props.search) {\n      this.fetchDataDebounced({\n        pageSize: PAGE_SIZE,\n        pageIndex: 0,\n        sortBy: this.initialSort,\n        filters: {},\n      });\n    }\n  }\n\n  columns = [\n    {\n      accessor: 'dashboard_title',\n      Header: 'Dashboard',\n      sortable: true,\n      Cell: ({\n        row: {\n          original: { url, dashboard_title: dashboardTitle },\n        },\n      }) => <a href={url}>{dashboardTitle}</a>,\n    },\n    {\n      accessor: 'changed_by_fk',\n      Header: 'Creator',\n      sortable: true,\n      Cell: ({\n        row: {\n          original: { changed_by_name: changedByName, changedByUrl },\n        },\n      }) => <a href={changedByUrl}>{changedByName}</a>,\n    },\n    {\n      accessor: 'changed_on',\n      Header: 'Modified',\n      sortable: true,\n      Cell: ({\n        row: {\n          original: { changed_on: changedOn },\n        },\n      }) => <span className=\"no-wrap\">{moment(changedOn).fromNow()}</span>,\n    },\n  ];\n\n  initialSort = [{ id: 'changed_on', desc: true }];\n\n  fetchData = ({ pageIndex, pageSize, sortBy, filters }) => {\n    this.setState({ loading: true });\n    const filterExps = Object.keys(filters)\n      .map(fk => ({\n        col: fk,\n        opr: filters[fk].filterId,\n        value: filters[fk].filterValue,\n      }))\n      .concat(\n        this.props.search\n          ? [\n              {\n                col: 'dashboard_title',\n                opr: 'ct',\n                value: this.props.search,\n              },\n            ]\n          : [],\n      );\n\n    const queryParams = JSON.stringify({\n      order_column: sortBy[0].id,\n      order_direction: sortBy[0].desc ? 'desc' : 'asc',\n      page: pageIndex,\n      page_size: pageSize,\n      ...(filterExps.length ? { filters: filterExps } : {}),\n    });\n\n    return SupersetClient.get({\n      endpoint: `/api/v1/dashboard/?q=${queryParams}`,\n    })\n      .then(({ json }) => {\n        this.setState({ dashboards: json.result, dashboard_count: json.count });\n      })\n      .catch(response => {\n        if (response.status === 401) {\n          this.props.addDangerToast(\n            t(\n              \"You don't have the necessary permissions to load dashboards. Please contact your administrator.\",\n            ),\n          );\n        } else {\n          this.props.addDangerToast(\n            t('An error occurred while fetching Dashboards'),\n          );\n        }\n      })\n      .finally(() => this.setState({ loading: false }));\n  };\n\n  fetchDataDebounced = debounce(this.fetchData, 200);\n\n  render() {\n    return (\n      <ListView\n        columns={this.columns}\n        data={this.state.dashboards}\n        count={this.state.dashboard_count}\n        pageSize={PAGE_SIZE}\n        fetchData={this.fetchData}\n        loading={this.state.loading}\n        initialSort={this.initialSort}\n      />\n    );\n  }\n}\n\nexport default withToasts(DashboardTable);\n"]},"metadata":{},"sourceType":"module"}