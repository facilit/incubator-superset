{"ast":null,"code":"import \"core-js/modules/es.symbol.description\";import \"core-js/modules/es.regexp.to-string\";import \"core-js/modules/web.dom-collections.iterator\";import _Date$now from \"@babel/runtime-corejs3/core-js-stable/date/now\";import _Object$values from \"@babel/runtime-corejs3/core-js-stable/object/values\";import _filterInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/filter\";import _Object$assign from \"@babel/runtime-corejs3/core-js-stable/object/assign\";import _forEachInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/for-each\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\nimport { t } from '@superset-ui/translation';\nimport getToastsFromPyFlashMessages from '../../messageToasts/utils/getToastsFromPyFlashMessages';\n\nexport default function getInitialState({\n  defaultDbId,\n  common,\n  active_tab: activeTab,\n  tab_state_ids: tabStateIds = [],\n  databases,\n  queries: queries_,\n  requested_query: requestedQuery })\n{\n  /**\n   * Before YYYY-MM-DD, the state for SQL Lab was stored exclusively in the\n   * browser's localStorage. The feature flag `SQLLAB_BACKEND_PERSISTENCE`\n   * moves the state to the backend instead, migrating it from local storage.\n   *\n   * To allow for a transparent migration, the initial state is a combination\n   * of the backend state (if any) with the browser state (if any).\n   */\n  const queryEditors = [];\n  const defaultQueryEditor = {\n    id: null,\n    loaded: true,\n    title: t('Untitled Query'),\n    sql: 'SELECT *\\nFROM\\nWHERE',\n    selectedText: null,\n    latestQueryId: null,\n    autorun: false,\n    templateParams: null,\n    dbId: defaultDbId,\n    queryLimit: common.conf.DEFAULT_SQLLAB_LIMIT,\n    validationResult: {\n      id: null,\n      errors: [],\n      completed: false },\n\n    queryCostEstimate: {\n      cost: null,\n      completed: false,\n      error: null } };\n\n\n\n  /**\n                        * Load state from the backend. This will be empty if the feature flag\n                        * `SQLLAB_BACKEND_PERSISTENCE` is off.\n                        */\n  _forEachInstanceProperty(tabStateIds).call(tabStateIds, ({ id, label }) => {\n    let queryEditor;\n    if (activeTab && activeTab.id === id) {\n      queryEditor = {\n        id: id.toString(),\n        loaded: true,\n        title: activeTab.label,\n        sql: activeTab.sql,\n        selectedText: null,\n        latestQueryId: activeTab.latest_query ?\n        activeTab.latest_query.id :\n        null,\n        autorun: activeTab.autorun,\n        templateParams: activeTab.template_params,\n        dbId: activeTab.database_id,\n        schema: activeTab.schema,\n        queryLimit: activeTab.query_limit,\n        validationResult: {\n          id: null,\n          errors: [],\n          completed: false } };\n\n\n    } else {\n      // dummy state, actual state will be loaded on tab switch\n      queryEditor = _Object$assign({},\n      defaultQueryEditor, {\n        id: id.toString(),\n        loaded: false,\n        title: label });\n\n    }\n    queryEditors.push(queryEditor);\n  });\n\n  const tabHistory = activeTab ? [activeTab.id.toString()] : [];\n  const tables = [];\n  if (activeTab) {var _context, _context2;\n    _forEachInstanceProperty(_context = _filterInstanceProperty(_context2 = activeTab.table_schemas).call(_context2,\n    tableSchema => tableSchema.description !== null)).call(_context,\n    tableSchema => {\n      const {\n        columns,\n        selectStar,\n        primaryKey,\n        foreignKeys,\n        indexes,\n        dataPreviewQueryId } =\n      tableSchema.description;\n      const table = {\n        dbId: tableSchema.database_id,\n        queryEditorId: tableSchema.tab_state_id.toString(),\n        schema: tableSchema.schema,\n        name: tableSchema.table,\n        expanded: tableSchema.expanded,\n        id: tableSchema.id,\n        isMetadataLoading: false,\n        isExtraMetadataLoading: false,\n        dataPreviewQueryId,\n        columns,\n        selectStar,\n        primaryKey,\n        foreignKeys,\n        indexes };\n\n      tables.push(table);\n    });\n  }\n\n  const queries = _Object$assign({}, queries_);\n\n  /**\n                                                 * If the `SQLLAB_BACKEND_PERSISTENCE` feature flag is off, or if the user\n                                                 * hasn't used SQL Lab after it has been turned on, the state will be stored\n                                                 * in the browser's local storage.\n                                                 */\n  if (\n  localStorage.getItem('redux') &&\n  JSON.parse(localStorage.getItem('redux')).sqlLab)\n  {\n    const sqlLab = JSON.parse(localStorage.getItem('redux')).sqlLab;\n\n    if (sqlLab.queryEditors.length === 0) {\n      // migration was successful\n      localStorage.removeItem('redux');\n    } else {var _context3, _context4, _context5;\n      // add query editors and tables to state with a special flag so they can\n      // be migrated if the `SQLLAB_BACKEND_PERSISTENCE` feature flag is on\n      _forEachInstanceProperty(_context3 = sqlLab.queryEditors).call(_context3, (qe) =>\n      queryEditors.push(_Object$assign({},\n      qe, {\n        inLocalStorage: true,\n        loaded: true })));\n\n\n      _forEachInstanceProperty(_context4 = sqlLab.tables).call(_context4, (table) =>\n      tables.push(_Object$assign({}, table, { inLocalStorage: true })));\n\n      _forEachInstanceProperty(_context5 = _Object$values(sqlLab.queries)).call(_context5, query => {\n        queries[query.id] = _Object$assign({}, query, { inLocalStorage: true });\n      });\n      tabHistory.push(...sqlLab.tabHistory);\n    }\n  }\n\n  return {\n    sqlLab: {\n      activeSouthPaneTab: 'Results',\n      alerts: [],\n      databases,\n      offline: false,\n      queries,\n      queryEditors,\n      tabHistory,\n      tables,\n      queriesLastUpdate: _Date$now() },\n\n    requestedQuery,\n    messageToasts: getToastsFromPyFlashMessages(\n    (common || {}).flash_messages || []),\n\n    localStorageUsageInKilobytes: 0,\n    common: {\n      flash_messages: common.flash_messages,\n      conf: common.conf } };\n\n\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(getInitialState, \"getInitialState\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/reducers/getInitialState.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/reducers/getInitialState.js"],"names":["t","getToastsFromPyFlashMessages","getInitialState","defaultDbId","common","active_tab","activeTab","tab_state_ids","tabStateIds","databases","queries","queries_","requested_query","requestedQuery","queryEditors","defaultQueryEditor","id","loaded","title","sql","selectedText","latestQueryId","autorun","templateParams","dbId","queryLimit","conf","DEFAULT_SQLLAB_LIMIT","validationResult","errors","completed","queryCostEstimate","cost","error","label","queryEditor","toString","latest_query","template_params","database_id","schema","query_limit","push","tabHistory","tables","table_schemas","tableSchema","description","columns","selectStar","primaryKey","foreignKeys","indexes","dataPreviewQueryId","table","queryEditorId","tab_state_id","name","expanded","isMetadataLoading","isExtraMetadataLoading","localStorage","getItem","JSON","parse","sqlLab","length","removeItem","qe","inLocalStorage","query","activeSouthPaneTab","alerts","offline","queriesLastUpdate","messageToasts","flash_messages","localStorageUsageInKilobytes"],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/translation';\nimport getToastsFromPyFlashMessages from '../../messageToasts/utils/getToastsFromPyFlashMessages';\n\nexport default function getInitialState({\n  defaultDbId,\n  common,\n  active_tab: activeTab,\n  tab_state_ids: tabStateIds = [],\n  databases,\n  queries: queries_,\n  requested_query: requestedQuery,\n}) {\n  /**\n   * Before YYYY-MM-DD, the state for SQL Lab was stored exclusively in the\n   * browser's localStorage. The feature flag `SQLLAB_BACKEND_PERSISTENCE`\n   * moves the state to the backend instead, migrating it from local storage.\n   *\n   * To allow for a transparent migration, the initial state is a combination\n   * of the backend state (if any) with the browser state (if any).\n   */\n  const queryEditors = [];\n  const defaultQueryEditor = {\n    id: null,\n    loaded: true,\n    title: t('Untitled Query'),\n    sql: 'SELECT *\\nFROM\\nWHERE',\n    selectedText: null,\n    latestQueryId: null,\n    autorun: false,\n    templateParams: null,\n    dbId: defaultDbId,\n    queryLimit: common.conf.DEFAULT_SQLLAB_LIMIT,\n    validationResult: {\n      id: null,\n      errors: [],\n      completed: false,\n    },\n    queryCostEstimate: {\n      cost: null,\n      completed: false,\n      error: null,\n    },\n  };\n\n  /**\n   * Load state from the backend. This will be empty if the feature flag\n   * `SQLLAB_BACKEND_PERSISTENCE` is off.\n   */\n  tabStateIds.forEach(({ id, label }) => {\n    let queryEditor;\n    if (activeTab && activeTab.id === id) {\n      queryEditor = {\n        id: id.toString(),\n        loaded: true,\n        title: activeTab.label,\n        sql: activeTab.sql,\n        selectedText: null,\n        latestQueryId: activeTab.latest_query\n          ? activeTab.latest_query.id\n          : null,\n        autorun: activeTab.autorun,\n        templateParams: activeTab.template_params,\n        dbId: activeTab.database_id,\n        schema: activeTab.schema,\n        queryLimit: activeTab.query_limit,\n        validationResult: {\n          id: null,\n          errors: [],\n          completed: false,\n        },\n      };\n    } else {\n      // dummy state, actual state will be loaded on tab switch\n      queryEditor = {\n        ...defaultQueryEditor,\n        id: id.toString(),\n        loaded: false,\n        title: label,\n      };\n    }\n    queryEditors.push(queryEditor);\n  });\n\n  const tabHistory = activeTab ? [activeTab.id.toString()] : [];\n  const tables = [];\n  if (activeTab) {\n    activeTab.table_schemas\n      .filter(tableSchema => tableSchema.description !== null)\n      .forEach(tableSchema => {\n        const {\n          columns,\n          selectStar,\n          primaryKey,\n          foreignKeys,\n          indexes,\n          dataPreviewQueryId,\n        } = tableSchema.description;\n        const table = {\n          dbId: tableSchema.database_id,\n          queryEditorId: tableSchema.tab_state_id.toString(),\n          schema: tableSchema.schema,\n          name: tableSchema.table,\n          expanded: tableSchema.expanded,\n          id: tableSchema.id,\n          isMetadataLoading: false,\n          isExtraMetadataLoading: false,\n          dataPreviewQueryId,\n          columns,\n          selectStar,\n          primaryKey,\n          foreignKeys,\n          indexes,\n        };\n        tables.push(table);\n      });\n  }\n\n  const queries = { ...queries_ };\n\n  /**\n   * If the `SQLLAB_BACKEND_PERSISTENCE` feature flag is off, or if the user\n   * hasn't used SQL Lab after it has been turned on, the state will be stored\n   * in the browser's local storage.\n   */\n  if (\n    localStorage.getItem('redux') &&\n    JSON.parse(localStorage.getItem('redux')).sqlLab\n  ) {\n    const sqlLab = JSON.parse(localStorage.getItem('redux')).sqlLab;\n\n    if (sqlLab.queryEditors.length === 0) {\n      // migration was successful\n      localStorage.removeItem('redux');\n    } else {\n      // add query editors and tables to state with a special flag so they can\n      // be migrated if the `SQLLAB_BACKEND_PERSISTENCE` feature flag is on\n      sqlLab.queryEditors.forEach(qe =>\n        queryEditors.push({\n          ...qe,\n          inLocalStorage: true,\n          loaded: true,\n        }),\n      );\n      sqlLab.tables.forEach(table =>\n        tables.push({ ...table, inLocalStorage: true }),\n      );\n      Object.values(sqlLab.queries).forEach(query => {\n        queries[query.id] = { ...query, inLocalStorage: true };\n      });\n      tabHistory.push(...sqlLab.tabHistory);\n    }\n  }\n\n  return {\n    sqlLab: {\n      activeSouthPaneTab: 'Results',\n      alerts: [],\n      databases,\n      offline: false,\n      queries,\n      queryEditors,\n      tabHistory,\n      tables,\n      queriesLastUpdate: Date.now(),\n    },\n    requestedQuery,\n    messageToasts: getToastsFromPyFlashMessages(\n      (common || {}).flash_messages || [],\n    ),\n    localStorageUsageInKilobytes: 0,\n    common: {\n      flash_messages: common.flash_messages,\n      conf: common.conf,\n    },\n  };\n}\n"]},"metadata":{},"sourceType":"module"}