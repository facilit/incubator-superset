{"ast":null,"code":"import _extends from \"@babel/runtime-corejs3/helpers/extends\";import _sliceInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/slice\";import _includesInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/includes\";import _entriesInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/entries\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _concatInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/concat\";import _filterInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/filter\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";import _Set from \"@babel/runtime-corejs3/core-js-stable/set\";var _jsxFileName = \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/VizTypeControl.jsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {\nLabel,\nRow,\nCol,\nFormControl,\nModal,\nOverlayTrigger,\nTooltip } from\n'react-bootstrap';\nimport { t } from '@superset-ui/translation';\nimport { getChartMetadataRegistry } from '@superset-ui/chart';\n\nimport ControlHeader from '../ControlHeader';\nimport './VizTypeControl.less';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nconst propTypes = {\n  description: PropTypes.string,\n  label: PropTypes.string,\n  name: PropTypes.string.isRequired,\n  onChange: PropTypes.func,\n  value: PropTypes.string.isRequired };\n\n\nconst defaultProps = {\n  onChange: () => {} };\n\n\nconst registry = getChartMetadataRegistry();\n\nconst IMAGE_PER_ROW = 6;\nconst LABEL_STYLE = { cursor: 'pointer' };\nconst DEFAULT_ORDER = [\n'line',\n'big_number',\n'table',\n'filter_box',\n'dist_bar',\n'area',\n'bar',\n'deck_polygon',\n'pie',\n'time_table',\n'pivot_table',\n'histogram',\n'big_number_total',\n'deck_scatter',\n'deck_hex',\n'time_pivot',\n'deck_arc',\n'heatmap',\n'deck_grid',\n'dual_line',\n'deck_screengrid',\n'line_multi',\n'treemap',\n'box_plot',\n'separator',\n'sunburst',\n'sankey',\n'word_cloud',\n'mapbox',\n'kepler',\n'cal_heatmap',\n'rose',\n'bubble',\n'deck_geojson',\n'horizon',\n'markup',\n'deck_multi',\n'compare',\n'partition',\n'event_flow',\n'deck_path',\n'directed_force',\n'world_map',\n'paired_ttest',\n'para',\n'iframe',\n'country_map'];\n\n\nconst typesWithDefaultOrder = new _Set(DEFAULT_ORDER);\n\nexport default class VizTypeControl extends React.PureComponent {\n  constructor(props) {var _context, _context2, _context3, _context4;\n    super(props);\n    this.state = {\n      showModal: false,\n      filter: '' };\n\n    this.toggleModal = _bindInstanceProperty(_context = this.toggleModal).call(_context, this);\n    this.changeSearch = _bindInstanceProperty(_context2 = this.changeSearch).call(_context2, this);\n    this.setSearchRef = _bindInstanceProperty(_context3 = this.setSearchRef).call(_context3, this);\n    this.focusSearch = _bindInstanceProperty(_context4 = this.focusSearch).call(_context4, this);\n  }\n\n  onChange(vizType) {\n    this.props.onChange(vizType);\n    this.setState({ showModal: false });\n  }\n\n  setSearchRef(searchRef) {\n    this.searchRef = searchRef;\n  }\n\n  toggleModal() {\n    this.setState({ showModal: !this.state.showModal });\n  }\n\n  changeSearch(event) {\n    this.setState({ filter: event.target.value });\n  }\n\n  focusSearch() {\n    if (this.searchRef) {\n      this.searchRef.focus();\n    }\n  }\n\n  renderItem(entry) {var _context5;\n    const { value } = this.props;\n    const { key, value: type } = entry;\n    const isSelected = key === value;\n\n    return (\n      ___EmotionJSX(\"div\", {\n        className: \"viztype-selector-container \" + (isSelected ? 'selected' : ''),\n        onClick: _bindInstanceProperty(_context5 = this.onChange).call(_context5, this, key), __source: { fileName: _jsxFileName, lineNumber: 146 }, __self: this },\n\n      ___EmotionJSX(\"img\", {\n        alt: type.name,\n        width: \"100%\",\n        className: \"viztype-selector \" + (isSelected ? 'selected' : ''),\n        src: type.thumbnail, __source: { fileName: _jsxFileName, lineNumber: 150 }, __self: this }),\n\n      ___EmotionJSX(\"div\", { className: \"viztype-label\", __source: { fileName: _jsxFileName, lineNumber: 156 }, __self: this }, type.name)));\n\n\n  }\n\n  render() {var _context6, _context7, _context8, _context9;\n    const { filter, showModal } = this.state;\n    const { value } = this.props;\n\n    const filterString = filter.toLowerCase();\n    const filteredTypes = _filterInstanceProperty(_context6 = _concatInstanceProperty(_context7 = _mapInstanceProperty(_context8 = _filterInstanceProperty(DEFAULT_ORDER).call(DEFAULT_ORDER, type => registry.has(type))).call(_context8,\n    type => ({\n      key: type,\n      value: registry.get(type) }))).call(_context7,\n\n\n    _filterInstanceProperty(_context9 = _entriesInstanceProperty(registry).call(registry)).call(_context9, ({ key }) => !typesWithDefaultOrder.has(key)))).call(_context6,\n\n    entry => {var _context10;return _includesInstanceProperty(_context10 = entry.value.name.toLowerCase()).call(_context10, filterString);});\n\n    const rows = [];\n    for (let i = 0; i <= filteredTypes.length; i += IMAGE_PER_ROW) {var _context11;\n      rows.push(\n      ___EmotionJSX(Row, { key: \"row-\" + i, __source: { fileName: _jsxFileName, lineNumber: 179 }, __self: this },\n      _mapInstanceProperty(_context11 = _sliceInstanceProperty(filteredTypes).call(filteredTypes, i, i + IMAGE_PER_ROW)).call(_context11, (entry) =>\n      ___EmotionJSX(Col, { md: 12 / IMAGE_PER_ROW, key: \"grid-col-\" + entry.key, __source: { fileName: _jsxFileName, lineNumber: 181 }, __self: this },\n      this.renderItem(entry)))));\n\n\n\n\n    }\n\n    return (\n      ___EmotionJSX(\"div\", { __source: { fileName: _jsxFileName, lineNumber: 190 }, __self: this },\n      ___EmotionJSX(ControlHeader, _extends({}, this.props, { __source: { fileName: _jsxFileName, lineNumber: 191 }, __self: this })),\n      ___EmotionJSX(OverlayTrigger, {\n        placement: \"right\",\n        overlay:\n        ___EmotionJSX(Tooltip, { id: \"error-tooltip\", __source: { fileName: _jsxFileName, lineNumber: 195 }, __self: this },\n        t('Click to change visualization type')), __source: { fileName: _jsxFileName, lineNumber: 192 }, __self: this },\n\n\n\n      ___EmotionJSX(React.Fragment, null,\n      ___EmotionJSX(Label, { onClick: this.toggleModal, style: LABEL_STYLE, __source: { fileName: _jsxFileName, lineNumber: 201 }, __self: this },\n      registry.has(value) ? registry.get(value).name : \"\" + value),\n\n      !registry.has(value) &&\n      ___EmotionJSX(\"div\", { className: \"text-danger\", __source: { fileName: _jsxFileName, lineNumber: 205 }, __self: this },\n      ___EmotionJSX(\"i\", { className: \"fa fa-exclamation-circle text-danger\", __source: { fileName: _jsxFileName, lineNumber: 206 }, __self: this }), ' ',\n      ___EmotionJSX(\"small\", { __source: { fileName: _jsxFileName, lineNumber: 207 }, __self: this }, t('This visualization type is not supported.'))))),\n\n\n\n\n      ___EmotionJSX(Modal, {\n        show: showModal,\n        onHide: this.toggleModal,\n        onEnter: this.focusSearch,\n        onExit: this.setSearchRef,\n        bsSize: \"lg\", __source: { fileName: _jsxFileName, lineNumber: 212 }, __self: this },\n\n      ___EmotionJSX(Modal.Header, { closeButton: true, __source: { fileName: _jsxFileName, lineNumber: 219 }, __self: this },\n      ___EmotionJSX(Modal.Title, { __source: { fileName: _jsxFileName, lineNumber: 220 }, __self: this }, t('Select a visualization type'))),\n\n      ___EmotionJSX(Modal.Body, { __source: { fileName: _jsxFileName, lineNumber: 222 }, __self: this },\n      ___EmotionJSX(\"div\", { className: \"viztype-control-search-box\", __source: { fileName: _jsxFileName, lineNumber: 223 }, __self: this },\n      ___EmotionJSX(FormControl, {\n        inputRef: this.setSearchRef,\n        type: \"text\",\n        value: filter,\n        placeholder: t('Search'),\n        onChange: this.changeSearch, __source: { fileName: _jsxFileName, lineNumber: 224 }, __self: this })),\n\n\n      rows))));\n\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nVizTypeControl.propTypes = propTypes;\nVizTypeControl.defaultProps = defaultProps;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/VizTypeControl.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/VizTypeControl.jsx\");reactHotLoader.register(registry, \"registry\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/VizTypeControl.jsx\");reactHotLoader.register(IMAGE_PER_ROW, \"IMAGE_PER_ROW\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/VizTypeControl.jsx\");reactHotLoader.register(LABEL_STYLE, \"LABEL_STYLE\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/VizTypeControl.jsx\");reactHotLoader.register(DEFAULT_ORDER, \"DEFAULT_ORDER\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/VizTypeControl.jsx\");reactHotLoader.register(typesWithDefaultOrder, \"typesWithDefaultOrder\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/VizTypeControl.jsx\");reactHotLoader.register(VizTypeControl, \"VizTypeControl\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/VizTypeControl.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/VizTypeControl.jsx"],"names":["React","PropTypes","Label","Row","Col","FormControl","Modal","OverlayTrigger","Tooltip","t","getChartMetadataRegistry","ControlHeader","propTypes","description","string","label","name","isRequired","onChange","func","value","defaultProps","registry","IMAGE_PER_ROW","LABEL_STYLE","cursor","DEFAULT_ORDER","typesWithDefaultOrder","VizTypeControl","PureComponent","constructor","props","state","showModal","filter","toggleModal","changeSearch","setSearchRef","focusSearch","vizType","setState","searchRef","event","target","focus","renderItem","entry","key","type","isSelected","thumbnail","render","filterString","toLowerCase","filteredTypes","has","get","rows","i","length","push"],"mappings":"sqCAAA;;;;;;;;;;;;;;;;;;AAkBA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA;AACEC,KADF;AAEEC,GAFF;AAGEC,GAHF;AAIEC,WAJF;AAKEC,KALF;AAMEC,cANF;AAOEC,OAPF;AAQO,iBARP;AASA,SAASC,CAAT,QAAkB,0BAAlB;AACA,SAASC,wBAAT,QAAyC,oBAAzC;;AAEA,OAAOC,aAAP,MAA0B,kBAA1B;AACA,OAAO,uBAAP,C;;AAEA,MAAMC,SAAS,GAAG;AAChBC,EAAAA,WAAW,EAAEZ,SAAS,CAACa,MADP;AAEhBC,EAAAA,KAAK,EAAEd,SAAS,CAACa,MAFD;AAGhBE,EAAAA,IAAI,EAAEf,SAAS,CAACa,MAAV,CAAiBG,UAHP;AAIhBC,EAAAA,QAAQ,EAAEjB,SAAS,CAACkB,IAJJ;AAKhBC,EAAAA,KAAK,EAAEnB,SAAS,CAACa,MAAV,CAAiBG,UALR,EAAlB;;;AAQA,MAAMI,YAAY,GAAG;AACnBH,EAAAA,QAAQ,EAAE,MAAM,CAAE,CADC,EAArB;;;AAIA,MAAMI,QAAQ,GAAGZ,wBAAwB,EAAzC;;AAEA,MAAMa,aAAa,GAAG,CAAtB;AACA,MAAMC,WAAW,GAAG,EAAEC,MAAM,EAAE,SAAV,EAApB;AACA,MAAMC,aAAa,GAAG;AACpB,MADoB;AAEpB,YAFoB;AAGpB,OAHoB;AAIpB,YAJoB;AAKpB,UALoB;AAMpB,MANoB;AAOpB,KAPoB;AAQpB,cARoB;AASpB,KAToB;AAUpB,YAVoB;AAWpB,aAXoB;AAYpB,WAZoB;AAapB,kBAboB;AAcpB,cAdoB;AAepB,UAfoB;AAgBpB,YAhBoB;AAiBpB,UAjBoB;AAkBpB,SAlBoB;AAmBpB,WAnBoB;AAoBpB,WApBoB;AAqBpB,iBArBoB;AAsBpB,YAtBoB;AAuBpB,SAvBoB;AAwBpB,UAxBoB;AAyBpB,WAzBoB;AA0BpB,UA1BoB;AA2BpB,QA3BoB;AA4BpB,YA5BoB;AA6BpB,QA7BoB;AA8BpB,QA9BoB;AA+BpB,aA/BoB;AAgCpB,MAhCoB;AAiCpB,QAjCoB;AAkCpB,cAlCoB;AAmCpB,SAnCoB;AAoCpB,QApCoB;AAqCpB,YArCoB;AAsCpB,SAtCoB;AAuCpB,WAvCoB;AAwCpB,YAxCoB;AAyCpB,WAzCoB;AA0CpB,gBA1CoB;AA2CpB,WA3CoB;AA4CpB,cA5CoB;AA6CpB,MA7CoB;AA8CpB,QA9CoB;AA+CpB,aA/CoB,CAAtB;;;AAkDA,MAAMC,qBAAqB,GAAG,SAAQD,aAAR,CAA9B;;AAEA,eAAe,MAAME,cAAN,SAA6B5B,KAAK,CAAC6B,aAAnC,CAAiD;AAC9DC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACXC,MAAAA,SAAS,EAAE,KADA;AAEXC,MAAAA,MAAM,EAAE,EAFG,EAAb;;AAIA,SAAKC,WAAL,GAAmB,sCAAKA,WAAL,iBAAsB,IAAtB,CAAnB;AACA,SAAKC,YAAL,GAAoB,uCAAKA,YAAL,kBAAuB,IAAvB,CAApB;AACA,SAAKC,YAAL,GAAoB,uCAAKA,YAAL,kBAAuB,IAAvB,CAApB;AACA,SAAKC,WAAL,GAAmB,uCAAKA,WAAL,kBAAsB,IAAtB,CAAnB;AACD;;AAEDpB,EAAAA,QAAQ,CAACqB,OAAD,EAAU;AAChB,SAAKR,KAAL,CAAWb,QAAX,CAAoBqB,OAApB;AACA,SAAKC,QAAL,CAAc,EAAEP,SAAS,EAAE,KAAb,EAAd;AACD;;AAEDI,EAAAA,YAAY,CAACI,SAAD,EAAY;AACtB,SAAKA,SAAL,GAAiBA,SAAjB;AACD;;AAEDN,EAAAA,WAAW,GAAG;AACZ,SAAKK,QAAL,CAAc,EAAEP,SAAS,EAAE,CAAC,KAAKD,KAAL,CAAWC,SAAzB,EAAd;AACD;;AAEDG,EAAAA,YAAY,CAACM,KAAD,EAAQ;AAClB,SAAKF,QAAL,CAAc,EAAEN,MAAM,EAAEQ,KAAK,CAACC,MAAN,CAAavB,KAAvB,EAAd;AACD;;AAEDkB,EAAAA,WAAW,GAAG;AACZ,QAAI,KAAKG,SAAT,EAAoB;AAClB,WAAKA,SAAL,CAAeG,KAAf;AACD;AACF;;AAEDC,EAAAA,UAAU,CAACC,KAAD,EAAQ;AAChB,UAAM,EAAE1B,KAAF,KAAY,KAAKW,KAAvB;AACA,UAAM,EAAEgB,GAAF,EAAO3B,KAAK,EAAE4B,IAAd,KAAuBF,KAA7B;AACA,UAAMG,UAAU,GAAGF,GAAG,KAAK3B,KAA3B;;AAEA;AACE;AACE,QAAA,SAAS,mCAAgC6B,UAAU,GAAG,UAAH,GAAgB,EAA1D,CADX;AAEE,QAAA,OAAO,EAAE,uCAAK/B,QAAL,kBAAmB,IAAnB,EAAyB6B,GAAzB,CAFX;;AAIE;AACE,QAAA,GAAG,EAAEC,IAAI,CAAChC,IADZ;AAEE,QAAA,KAAK,EAAC,MAFR;AAGE,QAAA,SAAS,yBAAsBiC,UAAU,GAAG,UAAH,GAAgB,EAAhD,CAHX;AAIE,QAAA,GAAG,EAAED,IAAI,CAACE,SAJZ,wEAJF;;AAUE,6BAAK,SAAS,EAAC,eAAf,yEAAgCF,IAAI,CAAChC,IAArC,CAVF,CADF;;;AAcD;;AAEDmC,EAAAA,MAAM,GAAG;AACP,UAAM,EAAEjB,MAAF,EAAUD,SAAV,KAAwB,KAAKD,KAAnC;AACA,UAAM,EAAEZ,KAAF,KAAY,KAAKW,KAAvB;;AAEA,UAAMqB,YAAY,GAAGlB,MAAM,CAACmB,WAAP,EAArB;AACA,UAAMC,aAAa,GAAG,iIAAA5B,aAAa,MAAb,CAAAA,aAAa,EAAQsB,IAAI,IAAI1B,QAAQ,CAACiC,GAAT,CAAaP,IAAb,CAAhB,CAAb;AACfA,IAAAA,IAAI,KAAK;AACZD,MAAAA,GAAG,EAAEC,IADO;AAEZ5B,MAAAA,KAAK,EAAEE,QAAQ,CAACkC,GAAT,CAAaR,IAAb,CAFK,EAAL,CADW;;;AAMlB,iEAAA1B,QAAQ,MAAR,CAAAA,QAAQ,OAAR,YAA0B,CAAC,EAAEyB,GAAF,EAAD,KAAa,CAACpB,qBAAqB,CAAC4B,GAAtB,CAA0BR,GAA1B,CAAxC,CANkB;;AAQZD,IAAAA,KAAK,2BAAI,uCAAAA,KAAK,CAAC1B,KAAN,CAAYJ,IAAZ,CAAiBqC,WAAjB,qBAAwCD,YAAxC,CAAJ,EARO,CAAtB;;AAUA,UAAMK,IAAI,GAAG,EAAb;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIJ,aAAa,CAACK,MAAnC,EAA2CD,CAAC,IAAInC,aAAhD,EAA+D;AAC7DkC,MAAAA,IAAI,CAACG,IAAL;AACE,oBAAC,GAAD,IAAK,GAAG,WAASF,CAAjB;AACG,+DAAAJ,aAAa,MAAb,CAAAA,aAAa,EAAOI,CAAP,EAAUA,CAAC,GAAGnC,aAAd,CAAb,mBAA8C,CAAAuB,KAAK;AAClD,oBAAC,GAAD,IAAK,EAAE,EAAE,KAAKvB,aAAd,EAA6B,GAAG,gBAAcuB,KAAK,CAACC,GAApD;AACG,WAAKF,UAAL,CAAgBC,KAAhB,CADH,CADD,CADH,CADF;;;;;AASD;;AAED;AACE;AACE,oBAAC,aAAD,eAAmB,KAAKf,KAAxB,2EADF;AAEE,oBAAC,cAAD;AACE,QAAA,SAAS,EAAC,OADZ;AAEE,QAAA,OAAO;AACL,sBAAC,OAAD,IAAS,EAAE,EAAC,eAAZ;AACGtB,QAAAA,CAAC,CAAC,oCAAD,CADJ,CAHJ;;;;AAQE;AACE,oBAAC,KAAD,IAAO,OAAO,EAAE,KAAK0B,WAArB,EAAkC,KAAK,EAAEX,WAAzC;AACGF,MAAAA,QAAQ,CAACiC,GAAT,CAAanC,KAAb,IAAsBE,QAAQ,CAACkC,GAAT,CAAapC,KAAb,EAAoBJ,IAA1C,QAAoDI,KADvD,CADF;;AAIG,OAACE,QAAQ,CAACiC,GAAT,CAAanC,KAAb,CAAD;AACC,6BAAK,SAAS,EAAC,aAAf;AACE,2BAAG,SAAS,EAAC,sCAAb,wEADF,EACyD,GADzD;AAEE,sGAAQX,CAAC,CAAC,2CAAD,CAAT,CAFF,CALJ,CARF,CAFF;;;;;AAsBE,oBAAC,KAAD;AACE,QAAA,IAAI,EAAEwB,SADR;AAEE,QAAA,MAAM,EAAE,KAAKE,WAFf;AAGE,QAAA,OAAO,EAAE,KAAKG,WAHhB;AAIE,QAAA,MAAM,EAAE,KAAKD,YAJf;AAKE,QAAA,MAAM,EAAC,IALT;;AAOE,oBAAC,KAAD,CAAO,MAAP,IAAc,WAAW,MAAzB;AACE,oBAAC,KAAD,CAAO,KAAP,2EAAc5B,CAAC,CAAC,6BAAD,CAAf,CADF,CAPF;;AAUE,oBAAC,KAAD,CAAO,IAAP;AACE,6BAAK,SAAS,EAAC,4BAAf;AACE,oBAAC,WAAD;AACE,QAAA,QAAQ,EAAE,KAAK4B,YADjB;AAEE,QAAA,IAAI,EAAC,MAFP;AAGE,QAAA,KAAK,EAAEH,MAHT;AAIE,QAAA,WAAW,EAAEzB,CAAC,CAAC,QAAD,CAJhB;AAKE,QAAA,QAAQ,EAAE,KAAK2B,YALjB,wEADF,CADF;;;AAUGqB,MAAAA,IAVH,CAVF,CAtBF,CADF;;;;;AAgDD,GArI6D;AAAA;AAAA;AAwIhE7B,cAAc,CAAChB,SAAf,GAA2BA,SAA3B;AACAgB,cAAc,CAACP,YAAf,GAA8BA,YAA9B,C,iLA7MMT,S,0JAQAS,Y,6JAIAC,Q,yJAEAC,a,8JACAC,W,4JACAE,a,8JAkDAC,qB,sKAEeC,c","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  Label,\n  Row,\n  Col,\n  FormControl,\n  Modal,\n  OverlayTrigger,\n  Tooltip,\n} from 'react-bootstrap';\nimport { t } from '@superset-ui/translation';\nimport { getChartMetadataRegistry } from '@superset-ui/chart';\n\nimport ControlHeader from '../ControlHeader';\nimport './VizTypeControl.less';\n\nconst propTypes = {\n  description: PropTypes.string,\n  label: PropTypes.string,\n  name: PropTypes.string.isRequired,\n  onChange: PropTypes.func,\n  value: PropTypes.string.isRequired,\n};\n\nconst defaultProps = {\n  onChange: () => {},\n};\n\nconst registry = getChartMetadataRegistry();\n\nconst IMAGE_PER_ROW = 6;\nconst LABEL_STYLE = { cursor: 'pointer' };\nconst DEFAULT_ORDER = [\n  'line',\n  'big_number',\n  'table',\n  'filter_box',\n  'dist_bar',\n  'area',\n  'bar',\n  'deck_polygon',\n  'pie',\n  'time_table',\n  'pivot_table',\n  'histogram',\n  'big_number_total',\n  'deck_scatter',\n  'deck_hex',\n  'time_pivot',\n  'deck_arc',\n  'heatmap',\n  'deck_grid',\n  'dual_line',\n  'deck_screengrid',\n  'line_multi',\n  'treemap',\n  'box_plot',\n  'separator',\n  'sunburst',\n  'sankey',\n  'word_cloud',\n  'mapbox',\n  'kepler',\n  'cal_heatmap',\n  'rose',\n  'bubble',\n  'deck_geojson',\n  'horizon',\n  'markup',\n  'deck_multi',\n  'compare',\n  'partition',\n  'event_flow',\n  'deck_path',\n  'directed_force',\n  'world_map',\n  'paired_ttest',\n  'para',\n  'iframe',\n  'country_map',\n];\n\nconst typesWithDefaultOrder = new Set(DEFAULT_ORDER);\n\nexport default class VizTypeControl extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showModal: false,\n      filter: '',\n    };\n    this.toggleModal = this.toggleModal.bind(this);\n    this.changeSearch = this.changeSearch.bind(this);\n    this.setSearchRef = this.setSearchRef.bind(this);\n    this.focusSearch = this.focusSearch.bind(this);\n  }\n\n  onChange(vizType) {\n    this.props.onChange(vizType);\n    this.setState({ showModal: false });\n  }\n\n  setSearchRef(searchRef) {\n    this.searchRef = searchRef;\n  }\n\n  toggleModal() {\n    this.setState({ showModal: !this.state.showModal });\n  }\n\n  changeSearch(event) {\n    this.setState({ filter: event.target.value });\n  }\n\n  focusSearch() {\n    if (this.searchRef) {\n      this.searchRef.focus();\n    }\n  }\n\n  renderItem(entry) {\n    const { value } = this.props;\n    const { key, value: type } = entry;\n    const isSelected = key === value;\n\n    return (\n      <div\n        className={`viztype-selector-container ${isSelected ? 'selected' : ''}`}\n        onClick={this.onChange.bind(this, key)}\n      >\n        <img\n          alt={type.name}\n          width=\"100%\"\n          className={`viztype-selector ${isSelected ? 'selected' : ''}`}\n          src={type.thumbnail}\n        />\n        <div className=\"viztype-label\">{type.name}</div>\n      </div>\n    );\n  }\n\n  render() {\n    const { filter, showModal } = this.state;\n    const { value } = this.props;\n\n    const filterString = filter.toLowerCase();\n    const filteredTypes = DEFAULT_ORDER.filter(type => registry.has(type))\n      .map(type => ({\n        key: type,\n        value: registry.get(type),\n      }))\n      .concat(\n        registry.entries().filter(({ key }) => !typesWithDefaultOrder.has(key)),\n      )\n      .filter(entry => entry.value.name.toLowerCase().includes(filterString));\n\n    const rows = [];\n    for (let i = 0; i <= filteredTypes.length; i += IMAGE_PER_ROW) {\n      rows.push(\n        <Row key={`row-${i}`}>\n          {filteredTypes.slice(i, i + IMAGE_PER_ROW).map(entry => (\n            <Col md={12 / IMAGE_PER_ROW} key={`grid-col-${entry.key}`}>\n              {this.renderItem(entry)}\n            </Col>\n          ))}\n        </Row>,\n      );\n    }\n\n    return (\n      <div>\n        <ControlHeader {...this.props} />\n        <OverlayTrigger\n          placement=\"right\"\n          overlay={\n            <Tooltip id=\"error-tooltip\">\n              {t('Click to change visualization type')}\n            </Tooltip>\n          }\n        >\n          <>\n            <Label onClick={this.toggleModal} style={LABEL_STYLE}>\n              {registry.has(value) ? registry.get(value).name : `${value}`}\n            </Label>\n            {!registry.has(value) && (\n              <div className=\"text-danger\">\n                <i className=\"fa fa-exclamation-circle text-danger\" />{' '}\n                <small>{t('This visualization type is not supported.')}</small>\n              </div>\n            )}\n          </>\n        </OverlayTrigger>\n        <Modal\n          show={showModal}\n          onHide={this.toggleModal}\n          onEnter={this.focusSearch}\n          onExit={this.setSearchRef}\n          bsSize=\"lg\"\n        >\n          <Modal.Header closeButton>\n            <Modal.Title>{t('Select a visualization type')}</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <div className=\"viztype-control-search-box\">\n              <FormControl\n                inputRef={this.setSearchRef}\n                type=\"text\"\n                value={filter}\n                placeholder={t('Search')}\n                onChange={this.changeSearch}\n              />\n            </div>\n            {rows}\n          </Modal.Body>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nVizTypeControl.propTypes = propTypes;\nVizTypeControl.defaultProps = defaultProps;\n"]},"metadata":{},"sourceType":"module"}