{"ast":null,"code":"import \"core-js/modules/es.string.split\";import _Object$keys from \"@babel/runtime-corejs3/core-js-stable/object/keys\";import _forEachInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/for-each\";import _Object$assign from \"@babel/runtime-corejs3/core-js-stable/object/assign\";var _context2;(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             */\n/* eslint camelcase: 0 */\nimport { getChartControlPanelRegistry } from '@superset-ui/chart';\nimport { getAllControlsState, getFormDataFromControls } from './controlUtils';\nimport controls from './controls';\n\nfunction handleDeprecatedControls(formData) {\n  // Reacffectation / handling of deprecated controls\n  /* eslint-disable no-param-reassign */\n\n  // y_axis_zero was a boolean forcing 0 to be part of the Y Axis\n  if (formData.y_axis_zero) {\n    formData.y_axis_bounds = [0, null];\n  }\n}\n\nexport function getControlsState(state, inputFormData) {\n  /*\n                                                         * Gets a new controls object to put in the state. The controls object\n                                                         * is similar to the configuration control with only the controls\n                                                         * related to the current viz_type, materializes mapStateToProps functions,\n                                                         * adds value keys coming from inputFormData passed here. This can't be an action creator\n                                                         * just yet because it's used in both the explore and dashboard views.\n                                                         * */\n\n  // Getting a list of active control names for the current viz\n  const formData = _Object$assign({}, inputFormData);\n  const vizType = formData.viz_type || 'table';\n\n  handleDeprecatedControls(formData);\n\n  const controlsState = getAllControlsState(\n  vizType,\n  state.datasource.type,\n  state,\n  formData);\n\n\n  const controlPanelConfig = getChartControlPanelRegistry().get(vizType) || {};\n  if (controlPanelConfig.onInit) {\n    return controlPanelConfig.onInit(controlsState);\n  }\n\n  return controlsState;\n}\n\nexport function applyDefaultFormData(inputFormData) {var _context;\n  const datasourceType = inputFormData.datasource.split('__')[1];\n  const vizType = inputFormData.viz_type;\n  const controlsState = getAllControlsState(vizType, datasourceType, null, _Object$assign({},\n  inputFormData));\n\n  const controlFormData = getFormDataFromControls(controlsState);\n\n  const formData = {};\n  _forEachInstanceProperty(_context = _Object$keys(controlsState)).call(_context, controlName => {\n    if (inputFormData[controlName] === undefined) {\n      formData[controlName] = controlFormData[controlName];\n    } else {\n      formData[controlName] = inputFormData[controlName];\n    }\n  });\n\n  // always use dynamically generated queryFields\n  formData.queryFields = controlFormData.queryFields;\n  return formData;\n}\n\nconst defaultControls = _Object$assign({}, controls);\n_forEachInstanceProperty(_context2 = _Object$keys(controls)).call(_context2, f => {\n  defaultControls[f].value = controls[f].default;\n});\n\nconst defaultState = {\n  controls: defaultControls,\n  form_data: getFormDataFromControls(defaultControls) };\n\n\nexport { defaultControls, defaultState };;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(handleDeprecatedControls, \"handleDeprecatedControls\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/store.js\");reactHotLoader.register(getControlsState, \"getControlsState\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/store.js\");reactHotLoader.register(applyDefaultFormData, \"applyDefaultFormData\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/store.js\");reactHotLoader.register(defaultControls, \"defaultControls\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/store.js\");reactHotLoader.register(defaultState, \"defaultState\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/store.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":null,"metadata":{},"sourceType":"module"}