{"ast":null,"code":"import _Object$assign from \"@babel/runtime-corejs3/core-js-stable/object/assign\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                          * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                          * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                          * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                          * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                          * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                          * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                          * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                          *\n                                                                                                                                                                                                                                                                                                                                                                                          *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                          *\n                                                                                                                                                                                                                                                                                                                                                                                          * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                          * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                          * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                          * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                          * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                          * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                          */\n/* eslint camelcase: 0 */\nimport { t } from '@superset-ui/translation';\nimport { now } from '../modules/dates';\nimport * as actions from './chartAction';\n\nexport const chart = {\n  id: 0,\n  chartAlert: null,\n  chartStatus: 'loading',\n  chartStackTrace: null,\n  chartUpdateEndTime: null,\n  chartUpdateStartTime: 0,\n  latestQueryFormData: {},\n  queryController: null,\n  queryResponse: null,\n  triggerQuery: true,\n  lastRendered: 0 };\n\n\nexport default function chartReducer(charts = {}, action) {\n  const actionHandlers = {\n    [actions.ADD_CHART]() {\n      return _Object$assign({},\n      chart, {},\n      action.chart);\n\n    },\n    [actions.CHART_UPDATE_SUCCEEDED](state) {\n      return _Object$assign({},\n      state, {\n        chartStatus: 'success',\n        queryResponse: action.queryResponse,\n        chartAlert: null,\n        chartUpdateEndTime: now() });\n\n    },\n    [actions.CHART_UPDATE_STARTED](state) {\n      return _Object$assign({},\n      state, {\n        chartStatus: 'loading',\n        chartStackTrace: null,\n        chartAlert: null,\n        chartUpdateEndTime: null,\n        chartUpdateStartTime: now(),\n        queryController: action.queryController });\n\n    },\n    [actions.CHART_UPDATE_STOPPED](state) {\n      return _Object$assign({},\n      state, {\n        chartStatus: 'stopped',\n        chartAlert: t('Updating chart was stopped'),\n        chartUpdateEndTime: now() });\n\n    },\n    [actions.CHART_RENDERING_SUCCEEDED](state) {\n      return _Object$assign({}, state, { chartStatus: 'rendered', chartUpdateEndTime: now() });\n    },\n    [actions.CHART_RENDERING_FAILED](state) {\n      return _Object$assign({},\n      state, {\n        chartStatus: 'failed',\n        chartStackTrace: action.stackTrace,\n        chartAlert: t(\n        'An error occurred while rendering the visualization: %s',\n        action.error) });\n\n\n    },\n    [actions.CHART_UPDATE_TIMEOUT](state) {\n      return _Object$assign({},\n      state, {\n        chartStatus: 'failed',\n        chartAlert:\n        t('Query timeout') + \" - \" +\n        t(\"visualization queries are set to timeout at \" +\n        action.timeout + \" seconds. \") +\n\n        t(\n        'Perhaps your data has grown, your database is under unusual load, ' +\n        'or you are simply querying a data source that is too large ' +\n        'to be processed within the timeout range. ' +\n        'If that is the case, we recommend that you summarize your data further.'),\n\n        chartUpdateEndTime: now() });\n\n    },\n    [actions.CHART_UPDATE_FAILED](state) {\n      return _Object$assign({},\n      state, {\n        chartStatus: 'failed',\n        chartAlert: action.queryResponse ?\n        action.queryResponse.error :\n        t('Network error.'),\n        chartUpdateEndTime: now(),\n        queryResponse: action.queryResponse,\n        chartStackTrace: action.queryResponse ?\n        action.queryResponse.stacktrace :\n        null });\n\n    },\n    [actions.TRIGGER_QUERY](state) {\n      return _Object$assign({},\n      state, {\n        triggerQuery: action.value,\n        chartStatus: 'loading' });\n\n    },\n    [actions.RENDER_TRIGGERED](state) {\n      return _Object$assign({}, state, { lastRendered: action.value });\n    },\n    [actions.UPDATE_QUERY_FORM_DATA](state) {\n      return _Object$assign({}, state, { latestQueryFormData: action.value });\n    },\n    [actions.ANNOTATION_QUERY_STARTED](state) {\n      if (\n      state.annotationQuery &&\n      state.annotationQuery[action.annotation.name])\n      {\n        state.annotationQuery[action.annotation.name].abort();\n      }\n      const annotationQuery = _Object$assign({},\n      state.annotationQuery, {\n        [action.annotation.name]: action.queryRequest });\n\n      return _Object$assign({},\n      state, {\n        annotationQuery });\n\n    },\n    [actions.ANNOTATION_QUERY_SUCCESS](state) {\n      const annotationData = _Object$assign({},\n      state.annotationData, {\n        [action.annotation.name]: action.queryResponse.data });\n\n      const annotationError = _Object$assign({}, state.annotationError);\n      delete annotationError[action.annotation.name];\n      const annotationQuery = _Object$assign({}, state.annotationQuery);\n      delete annotationQuery[action.annotation.name];\n      return _Object$assign({},\n      state, {\n        annotationData,\n        annotationError,\n        annotationQuery });\n\n    },\n    [actions.ANNOTATION_QUERY_FAILED](state) {\n      const annotationData = _Object$assign({}, state.annotationData);\n      delete annotationData[action.annotation.name];\n      const annotationError = _Object$assign({},\n      state.annotationError, {\n        [action.annotation.name]: action.queryResponse ?\n        action.queryResponse.error :\n        t('Network error.') });\n\n      const annotationQuery = _Object$assign({}, state.annotationQuery);\n      delete annotationQuery[action.annotation.name];\n      return _Object$assign({},\n      state, {\n        annotationData,\n        annotationError,\n        annotationQuery });\n\n    } };\n\n\n  /* eslint-disable no-param-reassign */\n  if (action.type === actions.REMOVE_CHART) {\n    delete charts[action.key];\n    return charts;\n  } else if (action.type === actions.UPDATE_CHART_ID) {\n    const { newId, key } = action;\n    charts[newId] = _Object$assign({},\n    charts[key], {\n      id: newId });\n\n    delete charts[key];\n    return charts;\n  }\n\n  if (action.type in actionHandlers) {\n    return _Object$assign({},\n    charts, {\n      [action.key]: actionHandlers[action.type](charts[action.key]) });\n\n  }\n\n  return charts;\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(chart, \"chart\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/chart/chartReducer.js\");reactHotLoader.register(chartReducer, \"chartReducer\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/chart/chartReducer.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":null,"metadata":{},"sourceType":"module"}