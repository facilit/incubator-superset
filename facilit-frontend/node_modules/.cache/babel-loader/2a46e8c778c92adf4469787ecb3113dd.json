{"ast":null,"code":"import \"core-js/modules/es.string.split\";import \"core-js/modules/web.dom-collections.iterator\";import _Object$entries from \"@babel/runtime-corejs3/core-js-stable/object/entries\";import _Object$assign from \"@babel/runtime-corejs3/core-js-stable/object/assign\";import _reduceInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/reduce\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        */\n/* eslint-disable camelcase */\nimport { TIME_FILTER_MAP } from '../../visualizations/FilterBox/FilterBox';\nimport {\nFILTER_CONFIG_ATTRIBUTES,\nTIME_FILTER_LABELS } from\n'../../explore/constants';\n\nexport default function getFilterConfigsFromFormdata(form_data = {}) {\n  const {\n    date_filter,\n    filter_configs = [],\n    show_druid_time_granularity,\n    show_druid_time_origin,\n    show_sqla_time_column,\n    show_sqla_time_granularity } =\n  form_data;\n  let configs = _reduceInstanceProperty(filter_configs).call(filter_configs,\n  ({ columns, labels }, config) => {\n    let defaultValues = config[FILTER_CONFIG_ATTRIBUTES.DEFAULT_VALUE];\n    // defaultValue could be ; separated values,\n    // could be null or ''\n    if (\n    config[FILTER_CONFIG_ATTRIBUTES.DEFAULT_VALUE] &&\n    config[FILTER_CONFIG_ATTRIBUTES.MULTIPLE])\n    {\n      defaultValues = config.defaultValue.split(';');\n    }\n    const updatedColumns = _Object$assign({},\n    columns, {\n      [config.column]: config.vals || defaultValues });\n\n    const updatedLabels = _Object$assign({},\n    labels, {\n      [config.column]: config.label });\n\n\n    return {\n      columns: updatedColumns,\n      labels: updatedLabels };\n\n  },\n  { columns: {}, labels: {} });\n\n\n  if (date_filter) {var _context;\n    let updatedColumns = _Object$assign({},\n    configs.columns, {\n      [TIME_FILTER_MAP.time_range]: form_data.time_range });\n\n    const updatedLabels = _Object$assign({},\n    configs.labels, {},\n    _reduceInstanceProperty(_context = _Object$entries(TIME_FILTER_MAP)).call(_context,\n    (map, [key, value]) => _Object$assign({},\n    map, {\n      [value]: TIME_FILTER_LABELS[key] }),\n\n    {}));\n\n\n\n    if (show_sqla_time_granularity) {\n      updatedColumns = _Object$assign({},\n      updatedColumns, {\n        [TIME_FILTER_MAP.time_grain_sqla]: form_data.time_grain_sqla });\n\n    }\n\n    if (show_sqla_time_column) {\n      updatedColumns = _Object$assign({},\n      updatedColumns, {\n        [TIME_FILTER_MAP.granularity_sqla]: form_data.granularity_sqla });\n\n    }\n\n    if (show_druid_time_granularity) {\n      updatedColumns = _Object$assign({},\n      updatedColumns, {\n        [TIME_FILTER_MAP.granularity]: form_data.granularity });\n\n    }\n\n    if (show_druid_time_origin) {\n      updatedColumns = _Object$assign({},\n      updatedColumns, {\n        [TIME_FILTER_MAP.druid_time_origin]: form_data.druid_time_origin });\n\n    }\n\n    configs = _Object$assign({},\n    configs, {\n      columns: updatedColumns,\n      labels: updatedLabels });\n\n  }\n  return configs;\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(getFilterConfigsFromFormdata, \"getFilterConfigsFromFormdata\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/dashboard/util/getFilterConfigsFromFormdata.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/tiago/git-facilit/incubator-superset/superset-frontend/src/dashboard/util/getFilterConfigsFromFormdata.js"],"names":["TIME_FILTER_MAP","FILTER_CONFIG_ATTRIBUTES","TIME_FILTER_LABELS","getFilterConfigsFromFormdata","form_data","date_filter","filter_configs","show_druid_time_granularity","show_druid_time_origin","show_sqla_time_column","show_sqla_time_granularity","configs","columns","labels","config","defaultValues","DEFAULT_VALUE","MULTIPLE","defaultValue","split","updatedColumns","column","vals","updatedLabels","label","time_range","map","key","value","time_grain_sqla","granularity_sqla","granularity","druid_time_origin"],"mappings":"uoBAAA;;;;;;;;;;;;;;;;;;AAkBA;AACA,SAASA,eAAT,QAAgC,0CAAhC;AACA;AACEC,wBADF;AAEEC,kBAFF;AAGO,yBAHP;;AAKA,eAAe,SAASC,4BAAT,CAAsCC,SAAS,GAAG,EAAlD,EAAsD;AACnE,QAAM;AACJC,IAAAA,WADI;AAEJC,IAAAA,cAAc,GAAG,EAFb;AAGJC,IAAAA,2BAHI;AAIJC,IAAAA,sBAJI;AAKJC,IAAAA,qBALI;AAMJC,IAAAA,0BANI;AAOFN,EAAAA,SAPJ;AAQA,MAAIO,OAAO,GAAG,wBAAAL,cAAc,MAAd,CAAAA,cAAc;AAC1B,GAAC,EAAEM,OAAF,EAAWC,MAAX,EAAD,EAAsBC,MAAtB,KAAiC;AAC/B,QAAIC,aAAa,GAAGD,MAAM,CAACb,wBAAwB,CAACe,aAA1B,CAA1B;AACA;AACA;AACA;AACEF,IAAAA,MAAM,CAACb,wBAAwB,CAACe,aAA1B,CAAN;AACAF,IAAAA,MAAM,CAACb,wBAAwB,CAACgB,QAA1B,CAFR;AAGE;AACAF,MAAAA,aAAa,GAAGD,MAAM,CAACI,YAAP,CAAoBC,KAApB,CAA0B,GAA1B,CAAhB;AACD;AACD,UAAMC,cAAc;AACfR,IAAAA,OADe;AAElB,OAACE,MAAM,CAACO,MAAR,GAAiBP,MAAM,CAACQ,IAAP,IAAeP,aAFd,GAApB;;AAIA,UAAMQ,aAAa;AACdV,IAAAA,MADc;AAEjB,OAACC,MAAM,CAACO,MAAR,GAAiBP,MAAM,CAACU,KAFP,GAAnB;;;AAKA,WAAO;AACLZ,MAAAA,OAAO,EAAEQ,cADJ;AAELP,MAAAA,MAAM,EAAEU,aAFH,EAAP;;AAID,GAxByB;AAyB1B,IAAEX,OAAO,EAAE,EAAX,EAAeC,MAAM,EAAE,EAAvB,EAzB0B,CAA5B;;;AA4BA,MAAIR,WAAJ,EAAiB;AACf,QAAIe,cAAc;AACbT,IAAAA,OAAO,CAACC,OADK;AAEhB,OAACZ,eAAe,CAACyB,UAAjB,GAA8BrB,SAAS,CAACqB,UAFxB,GAAlB;;AAIA,UAAMF,aAAa;AACdZ,IAAAA,OAAO,CAACE,MADM;AAEd,uDAAeb,eAAf;AACD,KAAC0B,GAAD,EAAM,CAACC,GAAD,EAAMC,KAAN,CAAN;AACKF,IAAAA,GADL;AAEE,OAACE,KAAD,GAAS1B,kBAAkB,CAACyB,GAAD,CAF7B,GADC;;AAKD,MALC,CAFc,CAAnB;;;;AAWA,QAAIjB,0BAAJ,EAAgC;AAC9BU,MAAAA,cAAc;AACTA,MAAAA,cADS;AAEZ,SAACpB,eAAe,CAAC6B,eAAjB,GAAmCzB,SAAS,CAACyB,eAFjC,GAAd;;AAID;;AAED,QAAIpB,qBAAJ,EAA2B;AACzBW,MAAAA,cAAc;AACTA,MAAAA,cADS;AAEZ,SAACpB,eAAe,CAAC8B,gBAAjB,GAAoC1B,SAAS,CAAC0B,gBAFlC,GAAd;;AAID;;AAED,QAAIvB,2BAAJ,EAAiC;AAC/Ba,MAAAA,cAAc;AACTA,MAAAA,cADS;AAEZ,SAACpB,eAAe,CAAC+B,WAAjB,GAA+B3B,SAAS,CAAC2B,WAF7B,GAAd;;AAID;;AAED,QAAIvB,sBAAJ,EAA4B;AAC1BY,MAAAA,cAAc;AACTA,MAAAA,cADS;AAEZ,SAACpB,eAAe,CAACgC,iBAAjB,GAAqC5B,SAAS,CAAC4B,iBAFnC,GAAd;;AAID;;AAEDrB,IAAAA,OAAO;AACFA,IAAAA,OADE;AAELC,MAAAA,OAAO,EAAEQ,cAFJ;AAGLP,MAAAA,MAAM,EAAEU,aAHH,GAAP;;AAKD;AACD,SAAOZ,OAAP;AACD,C,iLAxFuBR,4B","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable camelcase */\nimport { TIME_FILTER_MAP } from '../../visualizations/FilterBox/FilterBox';\nimport {\n  FILTER_CONFIG_ATTRIBUTES,\n  TIME_FILTER_LABELS,\n} from '../../explore/constants';\n\nexport default function getFilterConfigsFromFormdata(form_data = {}) {\n  const {\n    date_filter,\n    filter_configs = [],\n    show_druid_time_granularity,\n    show_druid_time_origin,\n    show_sqla_time_column,\n    show_sqla_time_granularity,\n  } = form_data;\n  let configs = filter_configs.reduce(\n    ({ columns, labels }, config) => {\n      let defaultValues = config[FILTER_CONFIG_ATTRIBUTES.DEFAULT_VALUE];\n      // defaultValue could be ; separated values,\n      // could be null or ''\n      if (\n        config[FILTER_CONFIG_ATTRIBUTES.DEFAULT_VALUE] &&\n        config[FILTER_CONFIG_ATTRIBUTES.MULTIPLE]\n      ) {\n        defaultValues = config.defaultValue.split(';');\n      }\n      const updatedColumns = {\n        ...columns,\n        [config.column]: config.vals || defaultValues,\n      };\n      const updatedLabels = {\n        ...labels,\n        [config.column]: config.label,\n      };\n\n      return {\n        columns: updatedColumns,\n        labels: updatedLabels,\n      };\n    },\n    { columns: {}, labels: {} },\n  );\n\n  if (date_filter) {\n    let updatedColumns = {\n      ...configs.columns,\n      [TIME_FILTER_MAP.time_range]: form_data.time_range,\n    };\n    const updatedLabels = {\n      ...configs.labels,\n      ...Object.entries(TIME_FILTER_MAP).reduce(\n        (map, [key, value]) => ({\n          ...map,\n          [value]: TIME_FILTER_LABELS[key],\n        }),\n        {},\n      ),\n    };\n\n    if (show_sqla_time_granularity) {\n      updatedColumns = {\n        ...updatedColumns,\n        [TIME_FILTER_MAP.time_grain_sqla]: form_data.time_grain_sqla,\n      };\n    }\n\n    if (show_sqla_time_column) {\n      updatedColumns = {\n        ...updatedColumns,\n        [TIME_FILTER_MAP.granularity_sqla]: form_data.granularity_sqla,\n      };\n    }\n\n    if (show_druid_time_granularity) {\n      updatedColumns = {\n        ...updatedColumns,\n        [TIME_FILTER_MAP.granularity]: form_data.granularity,\n      };\n    }\n\n    if (show_druid_time_origin) {\n      updatedColumns = {\n        ...updatedColumns,\n        [TIME_FILTER_MAP.druid_time_origin]: form_data.druid_time_origin,\n      };\n    }\n\n    configs = {\n      ...configs,\n      columns: updatedColumns,\n      labels: updatedLabels,\n    };\n  }\n  return configs;\n}\n"]},"metadata":{},"sourceType":"module"}