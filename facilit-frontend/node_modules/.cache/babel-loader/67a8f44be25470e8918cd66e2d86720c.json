{"ast":null,"code":"import _sliceInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/slice\";import _concatInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/concat\";import _Object$assign from \"@babel/runtime-corejs3/core-js-stable/object/assign\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n/* eslint camelcase: 0 */\nimport { getControlsState } from '../store';\nimport { getControlState, getFormDataFromControls } from '../controlUtils';\nimport * as actions from '../actions/exploreActions';\n\nexport default function exploreReducer(state = {}, action) {\n  const actionHandlers = {\n    [actions.TOGGLE_FAVE_STAR]() {\n      return _Object$assign({},\n      state, {\n        isStarred: action.isStarred });\n\n    },\n    [actions.POST_DATASOURCE_STARTED]() {\n      return _Object$assign({},\n      state, {\n        isDatasourceMetaLoading: true });\n\n    },\n    [actions.SET_DATASOURCE]() {\n      const newFormData = _Object$assign({}, state.form_data);\n      if (action.datasource.type !== state.datasource.type) {\n        if (action.datasource.type === 'table') {\n          newFormData.granularity_sqla = action.datasource.granularity_sqla;\n          newFormData.time_grain_sqla = action.datasource.time_grain_sqla;\n          delete newFormData.druid_time_origin;\n          delete newFormData.granularity;\n        } else {\n          newFormData.druid_time_origin = action.datasource.druid_time_origin;\n          newFormData.granularity = action.datasource.granularity;\n          delete newFormData.granularity_sqla;\n          delete newFormData.time_grain_sqla;\n        }\n      }\n      const newState = _Object$assign({},\n      state, {\n        datasource: action.datasource,\n        datasource_id: action.datasource.id,\n        datasource_type: action.datasource.type });\n\n      return _Object$assign({},\n      newState, {\n        form_data: newFormData,\n        controls: getControlsState(newState, newFormData) });\n\n    },\n    [actions.FETCH_DATASOURCES_STARTED]() {\n      return _Object$assign({},\n      state, {\n        isDatasourcesLoading: true });\n\n    },\n    [actions.FETCH_DATASOURCES_SUCCEEDED]() {\n      return _Object$assign({},\n      state, {\n        isDatasourcesLoading: false });\n\n    },\n    [actions.FETCH_DATASOURCES_FAILED]() {\n      return _Object$assign({},\n      state, {\n        isDatasourcesLoading: false,\n        controlPanelAlert: action.error });\n\n    },\n    [actions.SET_DATASOURCES]() {\n      return _Object$assign({},\n      state, {\n        datasources: action.datasources });\n\n    },\n    [actions.REMOVE_CONTROL_PANEL_ALERT]() {\n      return _Object$assign({},\n      state, {\n        controlPanelAlert: null });\n\n    },\n    [actions.SET_FIELD_VALUE]() {\n      const new_form_data = state.form_data;\n      new_form_data[action.controlName] = action.value;\n\n      // These errors are reported from the Control components\n      let errors = action.validationErrors || [];\n      const vizType = new_form_data.viz_type;\n      const control = _Object$assign({},\n      getControlState(action.controlName, vizType, state, action.value));\n\n\n      // These errors are based on control config `validators`\n      errors = _concatInstanceProperty(errors).call(errors, control.validationErrors || []);\n      const hasErrors = errors && errors.length > 0;\n      return _Object$assign({},\n      state, {\n        form_data: new_form_data,\n        triggerRender: control.renderTrigger && !hasErrors,\n        controls: _Object$assign({},\n        state.controls, {\n          [action.controlName]: _Object$assign({},\n          control, {\n            validationErrors: errors }) }) });\n\n\n\n    },\n    [actions.SET_EXPLORE_CONTROLS]() {\n      return _Object$assign({},\n      state, {\n        controls: getControlsState(state, action.formData) });\n\n    },\n    [actions.UPDATE_CHART_TITLE]() {\n      return _Object$assign({},\n      state, {\n        sliceName: action.sliceName });\n\n    },\n    [actions.RESET_FIELDS]() {\n      return _Object$assign({},\n      state, {\n        controls: getControlsState(\n        state,\n        getFormDataFromControls(state.controls)) });\n\n\n    },\n    [actions.CREATE_NEW_SLICE]() {\n      return _Object$assign({},\n      state, {\n        slice: _sliceInstanceProperty(action),\n        controls: getControlsState(state, action.form_data),\n        can_add: action.can_add,\n        can_download: action.can_download,\n        can_overwrite: action.can_overwrite });\n\n    },\n    [actions.SLICE_UPDATED]() {\n      return _Object$assign({},\n      state, {\n        slice: _Object$assign({}, _sliceInstanceProperty(\n        state), {}, _sliceInstanceProperty(\n        action)) });\n\n\n    } };\n\n  if (action.type in actionHandlers) {\n    return actionHandlers[action.type]();\n  }\n  return state;\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(exploreReducer, \"exploreReducer\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/reducers/exploreReducer.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":null,"metadata":{},"sourceType":"module"}