{"ast":null,"code":"import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _Date$now from \"@babel/runtime-corejs3/core-js-stable/date/now\";import _findInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/find\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport shortid from 'shortid';\nimport { Alert, Label, Tab, Tabs } from 'react-bootstrap';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { t } from '@superset-ui/translation';\nimport { isFeatureEnabled, FeatureFlag } from 'src/featureFlags';\n\nimport * as Actions from '../actions/sqlLab';\nimport QueryHistory from './QueryHistory';\nimport ResultSet from './ResultSet';\nimport {\nSTATUS_OPTIONS,\nSTATE_BSSTYLE_MAP,\nLOCALSTORAGE_MAX_QUERY_AGE_MS } from\n'../constants';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nconst TAB_HEIGHT = 44;\n\n/*\n                           editorQueries are queries executed by users passed from SqlEditor component\n                           dataPrebiewQueries are all queries executed for preview of table data (from SqlEditorLeft)\n                       */\nconst propTypes = {\n  editorQueries: PropTypes.array.isRequired,\n  latestQueryId: PropTypes.string,\n  dataPreviewQueries: PropTypes.array.isRequired,\n  actions: PropTypes.object.isRequired,\n  activeSouthPaneTab: PropTypes.string,\n  height: PropTypes.number,\n  databases: PropTypes.object.isRequired,\n  offline: PropTypes.bool,\n  displayLimit: PropTypes.number.isRequired };\n\n\nconst defaultProps = {\n  activeSouthPaneTab: 'Results',\n  offline: false };\n\n\nexport class SouthPane extends React.PureComponent {\n  constructor(props) {var _context, _context2;\n    super(props);\n    this.state = {\n      height: props.height };\n\n    this.southPaneRef = React.createRef();\n    this.getSouthPaneHeight = _bindInstanceProperty(_context = this.getSouthPaneHeight).call(_context, this);\n    this.switchTab = _bindInstanceProperty(_context2 = this.switchTab).call(_context2, this);\n  }\n  UNSAFE_componentWillReceiveProps() {\n    // south pane expands the entire height of the tab content on mount\n    this.setState({ height: this.getSouthPaneHeight() });\n  }\n  // One layer of abstraction for easy spying in unit tests\n  getSouthPaneHeight() {\n    return this.southPaneRef.current ?\n    this.southPaneRef.current.clientHeight :\n    0;\n  }\n  switchTab(id) {\n    this.props.actions.setActiveSouthPaneTab(id);\n  }\n  render() {var _context4;\n    if (this.props.offline) {\n      return (\n        ___EmotionJSX(Label, {\n          className: \"m-r-3\",\n          bsStyle: STATE_BSSTYLE_MAP[STATUS_OPTIONS.offline] },\n\n        STATUS_OPTIONS.offline));\n\n\n    }\n    const innerTabContentHeight = this.state.height - TAB_HEIGHT;\n    let latestQuery;\n    const props = this.props;\n    if (props.editorQueries.length > 0) {var _context3;\n      // get the latest query\n      latestQuery = _findInstanceProperty(_context3 = props.editorQueries).call(_context3,\n      q => q.id === this.props.latestQueryId);\n\n    }\n    let results;\n    if (latestQuery) {\n      if (\n      isFeatureEnabled(FeatureFlag.SQLLAB_BACKEND_PERSISTENCE) &&\n      latestQuery.state === 'success' &&\n      !latestQuery.resultsKey &&\n      !latestQuery.results)\n      {\n        results =\n        ___EmotionJSX(Alert, { bsStyle: \"warning\" },\n        t('No stored results found, you need to re-run your query'));\n\n\n      } else if (\n      _Date$now() - latestQuery.startDttm <=\n      LOCALSTORAGE_MAX_QUERY_AGE_MS)\n      {\n        results =\n        ___EmotionJSX(ResultSet, {\n          showControls: true,\n          search: true,\n          query: latestQuery,\n          actions: props.actions,\n          height: innerTabContentHeight,\n          database: this.props.databases[latestQuery.dbId],\n          displayLimit: this.props.displayLimit });\n\n\n      }\n    } else {\n      results =\n      ___EmotionJSX(Alert, { bsStyle: \"info\" }, t('Run a query to display results here'));\n\n    }\n    const dataPreviewTabs = _mapInstanceProperty(_context4 = props.dataPreviewQueries).call(_context4, (query) =>\n    ___EmotionJSX(Tab, {\n      title: t('Preview: `%s`', decodeURIComponent(query.tableName)),\n      eventKey: query.id,\n      key: query.id },\n\n    ___EmotionJSX(ResultSet, {\n      query: query,\n      visualize: false,\n      csv: false,\n      actions: props.actions,\n      cache: true,\n      height: innerTabContentHeight,\n      displayLimit: this.props.displayLimit })));\n\n\n\n\n    return (\n      ___EmotionJSX(\"div\", { className: \"SouthPane\", ref: this.southPaneRef },\n      ___EmotionJSX(Tabs, {\n        bsStyle: \"tabs\",\n        animation: false,\n        className: \"SouthPaneTabs\",\n        id: shortid.generate(),\n        activeKey: this.props.activeSouthPaneTab,\n        onSelect: this.switchTab },\n\n      ___EmotionJSX(Tab, { title: t('Results'), eventKey: \"Results\" },\n      results),\n\n      ___EmotionJSX(Tab, { title: t('Query History'), eventKey: \"History\" },\n      ___EmotionJSX(QueryHistory, {\n        queries: props.editorQueries,\n        actions: props.actions,\n        displayLimit: props.displayLimit })),\n\n\n      dataPreviewTabs)));\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nfunction mapStateToProps({ sqlLab }) {\n  return {\n    activeSouthPaneTab: sqlLab.activeSouthPaneTab,\n    databases: sqlLab.databases,\n    offline: sqlLab.offline };\n\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(Actions, dispatch) };\n\n}\n\nSouthPane.propTypes = propTypes;\nSouthPane.defaultProps = defaultProps;const _default =\n\nconnect(mapStateToProps, mapDispatchToProps)(SouthPane);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(TAB_HEIGHT, \"TAB_HEIGHT\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/SouthPane.jsx\");reactHotLoader.register(propTypes, \"propTypes\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/SouthPane.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/SouthPane.jsx\");reactHotLoader.register(SouthPane, \"SouthPane\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/SouthPane.jsx\");reactHotLoader.register(mapStateToProps, \"mapStateToProps\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/SouthPane.jsx\");reactHotLoader.register(mapDispatchToProps, \"mapDispatchToProps\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/SouthPane.jsx\");reactHotLoader.register(_default, \"default\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/SouthPane.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":null,"metadata":{},"sourceType":"module"}