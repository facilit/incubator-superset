{"ast":null,"code":"import _sortInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/sort\";import _sliceInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/slice\";import _JSON$stringify from \"@babel/runtime-corejs3/core-js-stable/json/stringify\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { ButtonGroup, Collapse, Fade, Well } from 'react-bootstrap';\nimport shortid from 'shortid';\nimport { t } from '@superset-ui/translation';\n\nimport CopyToClipboard from '../../components/CopyToClipboard';\nimport Link from '../../components/Link';\nimport ColumnElement from './ColumnElement';\nimport ShowSQL from './ShowSQL';\nimport ModalTrigger from '../../components/ModalTrigger';\nimport Loading from '../../components/Loading';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nconst propTypes = {\n  table: PropTypes.object,\n  actions: PropTypes.object,\n  timeout: PropTypes.number // used for tests\n};\n\nconst defaultProps = {\n  actions: {},\n  table: null,\n  timeout: 500 };\n\n\nclass TableElement extends React.PureComponent {\n  constructor(props) {var _context, _context2, _context3, _context4;\n    super(props);\n    this.state = {\n      sortColumns: false,\n      expanded: true,\n      hovered: false };\n\n    this.removeFromStore = _bindInstanceProperty(_context = this.removeFromStore).call(_context, this);\n    this.toggleSortColumns = _bindInstanceProperty(_context2 = this.toggleSortColumns).call(_context2, this);\n    this.removeTable = _bindInstanceProperty(_context3 = this.removeTable).call(_context3, this);\n    this.setHover = _bindInstanceProperty(_context4 = this.setHover).call(_context4, this);\n  }\n\n  setHover(hovered) {\n    this.setState({ hovered });\n  }\n\n  popSelectStar() {\n    const qe = {\n      id: shortid.generate(),\n      title: this.props.table.name,\n      dbId: this.props.table.dbId,\n      autorun: true,\n      sql: this.props.table.selectStar };\n\n    this.props.actions.addQueryEditor(qe);\n  }\n\n  toggleTable(e) {\n    e.preventDefault();\n    if (this.props.table.expanded) {\n      this.props.actions.collapseTable(this.props.table);\n    } else {\n      this.props.actions.expandTable(this.props.table);\n    }\n  }\n\n  removeTable() {\n    this.setState({ expanded: false });\n    this.props.actions.removeDataPreview(this.props.table);\n  }\n  toggleSortColumns() {\n    this.setState({ sortColumns: !this.state.sortColumns });\n  }\n\n  removeFromStore() {\n    this.props.actions.removeTable(this.props.table);\n  }\n\n  renderWell() {\n    const table = this.props.table;\n    let header;\n    if (table.partitions) {\n      let partitionQuery;\n      let partitionClipBoard;\n      if (table.partitions.partitionQuery) {\n        partitionQuery = table.partitions.partitionQuery;\n        const tt = t('Copy partition query to clipboard');\n        partitionClipBoard =\n        ___EmotionJSX(CopyToClipboard, {\n          text: partitionQuery,\n          shouldShowText: false,\n          tooltipText: tt,\n          copyNode: ___EmotionJSX(\"i\", { className: \"fa fa-clipboard\" }) });\n\n\n      }\n      let latest = [];\n      for (const k in table.partitions.latest) {\n        latest.push(k + \"=\" + table.partitions.latest[k]);\n      }\n      latest = latest.join('/');\n      header =\n      ___EmotionJSX(Well, { bsSize: \"small\" },\n      ___EmotionJSX(\"div\", null,\n      ___EmotionJSX(\"small\", null,\n      t('latest partition:'), \" \", latest),\n      ' ',\n      partitionClipBoard));\n\n\n\n    }\n    return header;\n  }\n  renderControls() {\n    let keyLink;\n    const table = this.props.table;\n    if (table.indexes && table.indexes.length > 0) {var _context5;\n      keyLink =\n      ___EmotionJSX(ModalTrigger, {\n        modalTitle:\n        ___EmotionJSX(\"div\", null,\n        t('Keys for table'), \" \", ___EmotionJSX(\"strong\", null, table.name)),\n\n\n        modalBody: _mapInstanceProperty(_context5 = table.indexes).call(_context5, (ix, i) =>\n        ___EmotionJSX(\"pre\", { key: i }, _JSON$stringify(ix, null, '  '))),\n\n        triggerNode:\n        ___EmotionJSX(Link, {\n          className: \"fa fa-key pull-left m-l-2\",\n          tooltip: t('View keys & indexes (%s)', table.indexes.length) }) });\n\n\n\n\n    }\n    return (\n      ___EmotionJSX(ButtonGroup, { className: \"ws-el-controls\" },\n      keyLink,\n      ___EmotionJSX(Link, {\n        className:\n        \"fa fa-sort-\" + (!this.state.sortColumns ? 'alpha' : 'numeric') + \"-asc \" +\n        'pull-left sort-cols m-l-2',\n\n        onClick: this.toggleSortColumns,\n        tooltip:\n        !this.state.sortColumns ?\n        t('Sort columns alphabetically') :\n        t('Original table column order'),\n\n        href: \"#\" }),\n\n      table.selectStar &&\n      ___EmotionJSX(CopyToClipboard, {\n        copyNode: ___EmotionJSX(\"a\", { className: \"fa fa-clipboard pull-left m-l-2\" }),\n        text: table.selectStar,\n        shouldShowText: false,\n        tooltipText: t('Copy SELECT statement to the clipboard') }),\n\n\n      table.view &&\n      ___EmotionJSX(ShowSQL, {\n        sql: table.view,\n        tooltipText: t('Show CREATE VIEW statement'),\n        title: t('CREATE VIEW statement') }),\n\n\n      ___EmotionJSX(Link, {\n        className: \"fa fa-times table-remove pull-left m-l-2\",\n        onClick: this.removeTable,\n        tooltip: t('Remove table preview'),\n        href: \"#\" })));\n\n\n\n  }\n  renderHeader() {\n    const table = this.props.table;\n    return (\n      ___EmotionJSX(\"div\", { className: \"clearfix\" },\n      ___EmotionJSX(\"div\", { className: \"pull-left\" },\n      ___EmotionJSX(\"a\", {\n        href: \"#\",\n        className: \"table-name\",\n        onClick: e => {\n          this.toggleTable(e);\n        } },\n\n      ___EmotionJSX(\"strong\", null, table.name))),\n\n\n      ___EmotionJSX(\"div\", { className: \"pull-right\" },\n      table.isMetadataLoading || table.isExtraMetadataLoading ?\n      ___EmotionJSX(Loading, { size: 50, position: \"normal\", className: \"margin-zero\" }) :\n\n      ___EmotionJSX(Fade, { in: this.state.hovered }, this.renderControls()),\n\n      ___EmotionJSX(\"i\", {\n        onClick: e => {\n          this.toggleTable(e);\n        },\n        className:\n        'text-primary pointer m-l-10 ' +\n        'fa fa-lg ' + (\"fa-angle-\" + (\n        table.expanded ? 'up' : 'down')) }))));\n\n\n\n\n\n  }\n  renderBody() {\n    const table = this.props.table;\n    let cols;\n    if (table.columns) {var _context6;\n      cols = _sliceInstanceProperty(_context6 = table.columns).call(_context6);\n      if (this.state.sortColumns) {\n        _sortInstanceProperty(cols).call(cols, (a, b) => {\n          const colA = a.name.toUpperCase();\n          const colB = b.name.toUpperCase();\n          if (colA < colB) {\n            return -1;\n          } else if (colA > colB) {\n            return 1;\n          }\n          return 0;\n        });\n      }\n    }\n    const metadata =\n    ___EmotionJSX(Collapse, { in: table.expanded, timeout: this.props.timeout },\n    ___EmotionJSX(\"div\", null,\n    this.renderWell(),\n    ___EmotionJSX(\"div\", { className: \"table-columns m-t-5\" },\n    cols &&\n    _mapInstanceProperty(cols).call(cols, col => ___EmotionJSX(ColumnElement, { column: col, key: col.name })))));\n\n\n\n\n    return metadata;\n  }\n\n  render() {\n    return (\n      ___EmotionJSX(Collapse, {\n        in: this.state.expanded,\n        timeout: this.props.timeout,\n        onExited: this.removeFromStore },\n\n      ___EmotionJSX(\"div\", {\n        className: \"TableElement table-schema m-b-10\",\n        onMouseEnter: () => this.setHover(true),\n        onMouseLeave: () => this.setHover(false) },\n\n      this.renderHeader(),\n      ___EmotionJSX(\"div\", null, this.renderBody()))));\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}TableElement.propTypes = propTypes;\nTableElement.defaultProps = defaultProps;const _default =\n\nTableElement;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/TableElement.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/TableElement.jsx\");reactHotLoader.register(TableElement, \"TableElement\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/TableElement.jsx\");reactHotLoader.register(_default, \"default\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/TableElement.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":null,"metadata":{},"sourceType":"module"}