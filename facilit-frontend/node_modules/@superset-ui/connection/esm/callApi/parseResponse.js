"use strict";

exports.__esModule = true;
exports.default = parseResponse;

function rejectIfNotOkay(response) {
  if (!response.ok) return Promise.reject(response);
  return Promise.resolve(response);
}

function parseResponse(apiPromise, parseMethod = 'json') {
  const checkedPromise = apiPromise.then(rejectIfNotOkay);

  if (parseMethod === null) {
    return apiPromise.then(rejectIfNotOkay);
  }

  if (parseMethod === 'text') {
    return checkedPromise.then(response => response.text().then(text => ({
      response,
      text
    })));
  }

  if (parseMethod === 'json') {
    return checkedPromise.then(response => response.json().then(json => ({
      json,
      response
    })));
  }

  throw new Error("Expected parseResponse=null|json|text, got '" + parseMethod + "'.");
}