{"ast":null,"code":"import _trimInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/trim\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { t } from '@superset-ui/translation';\nimport TooltipWrapper from './TooltipWrapper';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nconst propTypes = {\n  title: PropTypes.string,\n  canEdit: PropTypes.bool,\n  multiLine: PropTypes.bool,\n  onSaveTitle: PropTypes.func,\n  noPermitTooltip: PropTypes.string,\n  showTooltip: PropTypes.bool,\n  emptyText: PropTypes.node,\n  style: PropTypes.object,\n  extraClasses: PropTypes.oneOfType([\n  PropTypes.arrayOf(PropTypes.string),\n  PropTypes.string]) };\n\n\nconst defaultProps = {\n  title: t('Title'),\n  canEdit: false,\n  multiLine: false,\n  showTooltip: true,\n  onSaveTitle: () => {},\n  emptyText: '<empty>',\n  style: null,\n  extraClasses: null };\n\n\nexport default class EditableTitle extends React.PureComponent {\n  constructor(props) {var _context, _context2, _context3, _context4;\n    super(props);\n    this.state = {\n      isEditing: false,\n      title: this.props.title,\n      lastTitle: this.props.title };\n\n    this.handleClick = _bindInstanceProperty(_context = this.handleClick).call(_context, this);\n    this.handleBlur = _bindInstanceProperty(_context2 = this.handleBlur).call(_context2, this);\n    this.handleChange = _bindInstanceProperty(_context3 = this.handleChange).call(_context3, this);\n    this.handleKeyPress = _bindInstanceProperty(_context4 = this.handleKeyPress).call(_context4, this);\n\n    // Used so we can access the DOM element if a user clicks on this component.\n    this.contentRef = React.createRef();\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (nextProps.title !== this.state.title) {\n      this.setState({\n        lastTitle: this.state.title,\n        title: nextProps.title });\n\n    }\n  }\n\n  handleClick() {\n    if (!this.props.canEdit || this.state.isEditing) {\n      return;\n    }\n\n    // For multi-line values, save the actual rendered size of the displayed text.\n    // Later, if a textarea is constructed for editing the value, we'll need this.\n    const contentBoundingRect = this.contentRef.current ?\n    this.contentRef.current.getBoundingClientRect() :\n    null;\n\n    this.setState({ isEditing: true, contentBoundingRect });\n  }\n\n  handleBlur() {var _context5;\n    const title = _trimInstanceProperty(_context5 = this.state.title).call(_context5);\n\n    if (!this.props.canEdit) {\n      return;\n    }\n\n    this.setState({\n      isEditing: false });\n\n\n    if (!title.length) {\n      this.setState({\n        title: this.state.lastTitle });\n\n\n      return;\n    }\n\n    if (this.state.lastTitle !== title) {\n      this.setState({\n        lastTitle: title });\n\n    }\n\n    if (this.props.title !== title) {\n      this.props.onSaveTitle(title);\n    }\n  }\n\n  // this entire method exists to support using EditableTitle as the title of a\n  // react-bootstrap Tab, as a workaround for this line in react-bootstrap https://goo.gl/ZVLmv4\n  //\n  // tl;dr when a Tab EditableTitle is being edited, typically the Tab it's within has been\n  // clicked and is focused/active. for accessibility, when focused the Tab <a /> intercepts\n  // the ' ' key (among others, including all arrows) and onChange() doesn't fire. somehow\n  // keydown is still called so we can detect this and manually add a ' ' to the current title\n  handleKeyDown(event) {\n    if (event.key === ' ') {\n      event.stopPropagation();\n    }\n  }\n\n  handleChange(ev) {\n    if (!this.props.canEdit) {\n      return;\n    }\n    this.setState({\n      title: ev.target.value });\n\n  }\n\n  handleKeyPress(ev) {\n    if (ev.key === 'Enter') {\n      ev.preventDefault();\n      this.handleBlur();\n    }\n  }\n\n  render() {\n    const { isEditing, title, contentBoundingRect } = this.state;\n    const {\n      emptyText,\n      multiLine,\n      showTooltip,\n      canEdit,\n      noPermitTooltip,\n      style,\n      extraClasses } =\n    this.props;\n\n    let value;\n    if (title) {\n      value = title;\n    } else if (!isEditing) {\n      value = emptyText;\n    }\n\n    // Construct an inline style based on previously-saved height of the rendered label. Only\n    // used in multi-line contexts.\n    const editStyle =\n    isEditing && contentBoundingRect ?\n    { height: contentBoundingRect.height + \"px\" } :\n    null;\n\n    // Create a textarea when we're editing a multi-line value, otherwise create an input (which may\n    // be text or a button).\n    let input =\n    multiLine && isEditing ?\n    ___EmotionJSX(\"textarea\", {\n      ref: this.contentRef,\n      required: true,\n      value: value,\n      className: !title ? 'text-muted' : null,\n      onKeyDown: this.handleKeyDown,\n      onChange: this.handleChange,\n      onBlur: this.handleBlur,\n      onClick: this.handleClick,\n      onKeyPress: this.handleKeyPress,\n      style: editStyle }) :\n\n\n    ___EmotionJSX(\"input\", {\n      ref: this.contentRef,\n      required: true,\n      type: isEditing ? 'text' : 'button',\n      value: value,\n      className: !title ? 'text-muted' : null,\n      onKeyDown: this.handleKeyDown,\n      onChange: this.handleChange,\n      onBlur: this.handleBlur,\n      onClick: this.handleClick,\n      onKeyPress: this.handleKeyPress });\n\n\n    if (showTooltip && !isEditing) {\n      input =\n      ___EmotionJSX(TooltipWrapper, {\n        label: \"title\",\n        tooltip:\n        canEdit ?\n        t('click to edit') :\n        noPermitTooltip ||\n        t(\"You don't have the rights to alter this title.\") },\n\n\n      input);\n\n\n    }\n    return (\n      ___EmotionJSX(\"span\", {\n        className: cx(\n        'editable-title',\n        extraClasses,\n        canEdit && 'editable-title--editable',\n        isEditing && 'editable-title--editing'),\n\n        style: style },\n\n      input));\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}EditableTitle.propTypes = propTypes;\nEditableTitle.defaultProps = defaultProps;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/EditableTitle.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/EditableTitle.jsx\");reactHotLoader.register(EditableTitle, \"EditableTitle\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/EditableTitle.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":null,"metadata":{},"sourceType":"module"}