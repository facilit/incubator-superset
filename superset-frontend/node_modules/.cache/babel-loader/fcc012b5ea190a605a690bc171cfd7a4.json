{"ast":null,"code":"import \"core-js/modules/es.number.to-fixed\";import \"core-js/modules/es.regexp.to-string\";import \"core-js/modules/es.string.split\";import _filterInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/filter\";import _includesInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/includes\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";import _Object$assign from \"@babel/runtime-corejs3/core-js-stable/object/assign\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _reverseInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/reverse\";import _indexOfInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/index-of\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Table } from 'reactable-arc';\nimport { Label, ProgressBar, Well } from 'react-bootstrap';\nimport { t } from '@superset-ui/translation';\n\nimport Link from '../../components/Link';\nimport ResultSet from './ResultSet';\nimport ModalTrigger from '../../components/ModalTrigger';\nimport HighlightedSql from './HighlightedSql';\nimport { fDuration } from '../../modules/dates';\nimport { storeQuery } from '../../utils/common';\nimport QueryStateLabel from './QueryStateLabel';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nconst propTypes = {\n  columns: PropTypes.array,\n  actions: PropTypes.object,\n  queries: PropTypes.array,\n  onUserClicked: PropTypes.func,\n  onDbClicked: PropTypes.func,\n  displayLimit: PropTypes.number.isRequired };\n\nconst defaultProps = {\n  columns: ['started', 'duration', 'rows'],\n  queries: [],\n  onUserClicked: () => {},\n  onDbClicked: () => {} };\n\n\nclass QueryTable extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    const uri = window.location.toString();\n    const cleanUri = uri.substring(0, _indexOfInstanceProperty(uri).call(uri, '#'));\n    this.state = {\n      cleanUri,\n      showVisualizeModal: false,\n      activeQuery: null };\n\n  }\n  callback(url) {\n    window.open(url);\n  }\n  openQuery(dbId, schema, sql) {\n    const newQuery = {\n      dbId,\n      title: t('Untitled Query'),\n      schema,\n      sql };\n\n    storeQuery(newQuery).then(url => this.callback(url));\n  }\n  hideVisualizeModal() {\n    this.setState({ showVisualizeModal: false });\n  }\n  showVisualizeModal(query) {\n    this.setState({ activeQuery: query, showVisualizeModal: true });\n  }\n  restoreSql(query) {\n    this.props.actions.queryEditorSetSql({ id: query.sqlEditorId }, query.sql);\n  }\n\n  openQueryInNewTab(query) {\n    this.props.actions.cloneQueryToNewTab(query, true);\n  }\n  openAsyncResults(query, displayLimit) {\n    this.props.actions.fetchQueryResults(query, displayLimit);\n  }\n  clearQueryResults(query) {\n    this.props.actions.clearQueryResults(query);\n  }\n  removeQuery(query) {\n    this.props.actions.removeQuery(query);\n  }\n  render() {var _context, _context2;\n    const data = _reverseInstanceProperty(_context = _mapInstanceProperty(_context2 = this.props.queries).call(_context2,\n    query => {var _context3, _context4, _context5, _context10, _context11, _context12;\n      const q = _Object$assign({}, query);\n      if (q.endDttm) {\n        q.duration = fDuration(q.startDttm, q.endDttm);\n      }\n      const time = moment(q.startDttm).format().split('T');\n      q.time =\n      ___EmotionJSX(\"div\", null,\n      ___EmotionJSX(\"span\", null,\n      time[0], \" \", ___EmotionJSX(\"br\", null), \" \", time[1]));\n\n\n\n      q.user =\n      ___EmotionJSX(\"button\", {\n        className: \"btn btn-link btn-xs\",\n        onClick: _bindInstanceProperty(_context3 = this.props.onUserClicked).call(_context3, this, q.userId) },\n\n      q.user);\n\n\n      q.db =\n      ___EmotionJSX(\"button\", {\n        className: \"btn btn-link btn-xs\",\n        onClick: _bindInstanceProperty(_context4 = this.props.onDbClicked).call(_context4, this, q.dbId) },\n\n      q.db);\n\n\n      q.started = moment(q.startDttm).format('HH:mm:ss');\n      q.querylink =\n      ___EmotionJSX(\"div\", { style: { width: '100px' } },\n      ___EmotionJSX(\"button\", {\n        className: \"btn btn-link btn-xs\",\n        onClick: _bindInstanceProperty(_context5 = this.openQuery).call(_context5, this, q.dbId, q.schema, q.sql) },\n\n      ___EmotionJSX(\"i\", { className: \"fa fa-external-link\" }),\n      t('Open in SQL Editor')));\n\n\n\n      q.sql =\n      ___EmotionJSX(Well, null,\n      ___EmotionJSX(HighlightedSql, {\n        sql: q.sql,\n        rawSql: q.executedSql,\n        shrink: true,\n        maxWidth: 60 }));\n\n\n\n      if (q.resultsKey) {var _context6, _context7;\n        q.output =\n        ___EmotionJSX(ModalTrigger, {\n          bsSize: \"large\",\n          className: \"ResultsModal\",\n          triggerNode:\n          ___EmotionJSX(Label, { bsStyle: \"info\", style: { cursor: 'pointer' } },\n          t('view results')),\n\n\n          modalTitle: t('Data preview'),\n          beforeOpen: _bindInstanceProperty(_context6 = this.openAsyncResults).call(_context6,\n          this,\n          query,\n          this.props.displayLimit),\n\n          onExit: _bindInstanceProperty(_context7 = this.clearQueryResults).call(_context7, this, query),\n          modalBody:\n          ___EmotionJSX(ResultSet, {\n            showSql: true,\n            query: query,\n            actions: this.props.actions,\n            height: 400,\n            displayLimit: this.props.displayLimit }) });\n\n\n\n\n      } else {var _context8, _context9;\n        // if query was run using ctas and force_ctas_schema was set\n        // tempTable will have the schema\n        const schemaUsed =\n        q.ctas && q.tempTable && _includesInstanceProperty(_context8 = q.tempTable).call(_context8, '.') ? '' : q.schema;\n        q.output = _filterInstanceProperty(_context9 = [schemaUsed, q.tempTable]).call(_context9, v => v).join('.');\n      }\n      q.progress =\n      ___EmotionJSX(ProgressBar, {\n        style: { width: '75px' },\n        striped: true,\n        now: q.progress,\n        label: q.progress.toFixed(0) + \"%\" });\n\n\n      let errorTooltip;\n      if (q.errorMessage) {\n        errorTooltip =\n        ___EmotionJSX(Link, { tooltip: q.errorMessage },\n        ___EmotionJSX(\"i\", { className: \"fa fa-exclamation-circle text-danger\" }));\n\n\n      }\n      q.state =\n      ___EmotionJSX(\"div\", null,\n      ___EmotionJSX(QueryStateLabel, { query: query }),\n      errorTooltip);\n\n\n      q.actions =\n      ___EmotionJSX(\"div\", { style: { width: '75px' } },\n      ___EmotionJSX(Link, {\n        className: \"fa fa-pencil m-r-3\",\n        onClick: _bindInstanceProperty(_context10 = this.restoreSql).call(_context10, this, query),\n        tooltip: t(\n        'Overwrite text in the editor with a query on this table'),\n\n        placement: \"top\" }),\n\n      ___EmotionJSX(Link, {\n        className: \"fa fa-plus-circle m-r-3\",\n        onClick: _bindInstanceProperty(_context11 = this.openQueryInNewTab).call(_context11, this, query),\n        tooltip: t('Run query in a new tab'),\n        placement: \"top\" }),\n\n      ___EmotionJSX(Link, {\n        className: \"fa fa-trash m-r-3\",\n        tooltip: t('Remove query from log'),\n        onClick: _bindInstanceProperty(_context12 = this.removeQuery).call(_context12, this, query) }));\n\n\n\n      return q;\n    })).call(_context);\n\n    return (\n      ___EmotionJSX(\"div\", { className: \"QueryTable\" },\n      ___EmotionJSX(Table, {\n        columns: this.props.columns,\n        className: \"table table-condensed\",\n        data: data,\n        itemsPerPage: 50 })));\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}QueryTable.propTypes = propTypes;\nQueryTable.defaultProps = defaultProps;const _default =\n\nQueryTable;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/QueryTable.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/QueryTable.jsx\");reactHotLoader.register(QueryTable, \"QueryTable\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/QueryTable.jsx\");reactHotLoader.register(_default, \"default\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/QueryTable.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":null,"metadata":{},"sourceType":"module"}